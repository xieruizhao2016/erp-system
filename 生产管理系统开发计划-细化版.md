# ç”Ÿäº§ç®¡ç†ç³»ç»Ÿå¼€å‘è®¡åˆ’ - ç»†åŒ–ç‰ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### ç³»ç»Ÿåç§°ï¼šç”Ÿäº§ç®¡ç†ç³»ç»Ÿ (Production Management System, PMS) v2.0
### å¼€å‘ç†å¿µï¼šåŸºäºç°æœ‰yudao-ERPç³»ç»Ÿï¼Œæ„å»ºæ™ºèƒ½åŒ–ç”Ÿäº§ç®¡ç†è§£å†³æ–¹æ¡ˆ
### å¼€å‘æ¨¡å¼ï¼šæ•æ·å¼€å‘ + å¾®æœåŠ¡æ¶æ„ï¼ŒæŒç»­é›†æˆéƒ¨ç½²
### å¼€å‘å‘¨æœŸï¼šæ€»å‘¨æœŸçº¦ 18-20 å‘¨ï¼Œåˆ† 4 ä¸ªé˜¶æ®µå®æ–½
### æŠ€æœ¯æ ˆï¼šSpring Boot + MyBatis-Plus + Vue3 + TypeScript + Element Plus

---

## ğŸ”„ å¼€å‘æµç¨‹è§„èŒƒ

### æ ‡å‡†å¼€å‘æµç¨‹

æ‰€æœ‰æ–°åŠŸèƒ½å¼€å‘å¿…é¡»ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹æµç¨‹æ‰§è¡Œï¼Œç¡®ä¿å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ï¼š

#### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ•°æ®åº“è¡¨ç»“æ„
1. **è®¾è®¡è¡¨ç»“æ„**
   - æ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾è®¡å®Œæ•´çš„æ•°æ®åº“è¡¨ç»“æ„
   - åŒ…å«ä¸»è¡¨ã€æ˜ç»†è¡¨ã€å…³è”è¡¨ç­‰
   - è®¾è®¡åˆç†çš„ç´¢å¼•å’Œçº¦æŸ
   - è€ƒè™‘å¤šç§Ÿæˆ·ã€è½¯åˆ é™¤ç­‰ç³»ç»Ÿç‰¹æ€§

2. **ç¼–å†™SQLè„šæœ¬**
   - åœ¨ `sql/mysql/` ç›®å½•ä¸‹åˆ›å»ºæˆ–æ›´æ–°SQLè„šæœ¬
   - ä½¿ç”¨æ ‡å‡†çš„å»ºè¡¨è¯­å¥ï¼ŒåŒ…å«å®Œæ•´çš„å­—æ®µæ³¨é‡Š
   - æ·»åŠ å¿…è¦çš„ç´¢å¼•å’Œå¤–é”®çº¦æŸ
   - è€ƒè™‘æ•°æ®è¿ç§»å’Œç‰ˆæœ¬ç®¡ç†

3. **æ‰§è¡ŒSQLè„šæœ¬**
   - åœ¨å¼€å‘ç¯å¢ƒæ‰§è¡ŒSQLè„šæœ¬åˆ›å»ºè¡¨ç»“æ„
   - éªŒè¯è¡¨ç»“æ„æ˜¯å¦æ­£ç¡®åˆ›å»º
   - æ£€æŸ¥ç´¢å¼•å’Œçº¦æŸæ˜¯å¦ç”Ÿæ•ˆ

#### ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆä»£ç 
1. **é…ç½®ä»£ç ç”Ÿæˆå™¨**
   - è®¿é—®ç³»ç»Ÿä»£ç ç”Ÿæˆå™¨åŠŸèƒ½ï¼ˆé€šå¸¸åœ¨ç³»ç»Ÿç®¡ç†æ¨¡å—ï¼‰
   - é€‰æ‹©å¯¹åº”çš„æ•°æ®åº“è¡¨
   - é…ç½®ç”Ÿæˆé€‰é¡¹ï¼š
     - æ¨¡å—åç§°ï¼ˆå¦‚ï¼šerpï¼‰
     - ä¸šåŠ¡åç§°ï¼ˆå¦‚ï¼šç”Ÿäº§è®¢å•ï¼‰
     - ç±»åï¼ˆå¦‚ï¼šProductionOrderï¼‰
     - åŒ…è·¯å¾„ï¼ˆå¦‚ï¼šcn.iocoder.yudao.module.erpï¼‰
     - ä½œè€…ä¿¡æ¯

2. **ç”Ÿæˆåç«¯ä»£ç **
   - Controllerï¼ˆæ§åˆ¶å™¨ï¼‰
   - Serviceï¼ˆæœåŠ¡æ¥å£å’Œå®ç°ï¼‰
   - Mapperï¼ˆæ•°æ®è®¿é—®å±‚ï¼‰
   - DOï¼ˆæ•°æ®å¯¹è±¡ï¼‰
   - VOï¼ˆè§†å›¾å¯¹è±¡ï¼šReqVOã€RespVOï¼‰
   - Convertï¼ˆå¯¹è±¡è½¬æ¢å™¨ï¼‰

3. **ç”Ÿæˆå‰ç«¯ä»£ç **
   - APIæ¥å£æ–‡ä»¶ï¼ˆTypeScriptï¼‰
   - åˆ—è¡¨é¡µé¢ï¼ˆindex.vueï¼‰
   - è¡¨å•é¡µé¢ï¼ˆForm.vueï¼‰
   - ç±»å‹å®šä¹‰æ–‡ä»¶

#### ç¬¬ä¸‰æ­¥ï¼šè°ƒè¯•ä¼˜åŒ–ä»£ç 
1. **åŠŸèƒ½è°ƒè¯•**
   - æµ‹è¯•åŸºç¡€çš„CRUDåŠŸèƒ½
   - éªŒè¯æ•°æ®æ ¡éªŒé€»è¾‘
   - æµ‹è¯•åˆ†é¡µã€æ’åºã€ç­›é€‰åŠŸèƒ½
   - æ£€æŸ¥æƒé™æ§åˆ¶æ˜¯å¦æ­£ç¡®

2. **ä¸šåŠ¡é€»è¾‘ä¼˜åŒ–**
   - æ ¹æ®ä¸šåŠ¡éœ€æ±‚å®Œå–„Serviceå±‚é€»è¾‘
   - æ·»åŠ ä¸šåŠ¡æ ¡éªŒå’Œå¼‚å¸¸å¤„ç†
   - å®ç°å¤æ‚æŸ¥è¯¢å’Œç»Ÿè®¡åŠŸèƒ½
   - ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½

3. **å‰ç«¯ç•Œé¢ä¼˜åŒ–**
   - è°ƒæ•´è¡¨å•å¸ƒå±€å’Œå­—æ®µé¡ºåº
   - ä¼˜åŒ–åˆ—è¡¨å±•ç¤ºå’Œæœç´¢åŠŸèƒ½
   - æ·»åŠ ä¸šåŠ¡ç›¸å…³çš„è‡ªå®šä¹‰ç»„ä»¶
   - å®Œå–„ç”¨æˆ·äº¤äº’ä½“éªŒ

4. **ä»£ç è´¨é‡ä¼˜åŒ–**
   - ä»£ç å®¡æŸ¥å’Œé‡æ„
   - æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£
   - ç¼–å†™å•å…ƒæµ‹è¯•
   - æ€§èƒ½ä¼˜åŒ–å’Œå¼‚å¸¸å¤„ç†

### å¼€å‘æµç¨‹ç¤ºä¾‹

ä»¥"ç”Ÿäº§è®¢å•ç®¡ç†"åŠŸèƒ½ä¸ºä¾‹ï¼š

```
1. åˆ›å»ºæ•°æ®åº“è¡¨
   â”œâ”€â”€ æ‰§è¡Œ sql/mysql/erp-tables.sql ä¸­çš„ erp_production_order è¡¨
   â””â”€â”€ éªŒè¯è¡¨ç»“æ„åˆ›å»ºæˆåŠŸ

2. ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨
   â”œâ”€â”€ é…ç½®ï¼šæ¨¡å—=erp, ä¸šåŠ¡=ç”Ÿäº§è®¢å•, ç±»å=ProductionOrder
   â”œâ”€â”€ ç”Ÿæˆåç«¯ä»£ç ï¼ˆControllerã€Serviceã€Mapperç­‰ï¼‰
   â””â”€â”€ ç”Ÿæˆå‰ç«¯ä»£ç ï¼ˆAPIã€é¡µé¢ç­‰ï¼‰

3. è°ƒè¯•ä¼˜åŒ–
   â”œâ”€â”€ æµ‹è¯•åŸºç¡€CRUDåŠŸèƒ½
   â”œâ”€â”€ å®Œå–„çŠ¶æ€æµè½¬é€»è¾‘
   â”œâ”€â”€ æ·»åŠ ç‰©æ–™è½¬åŒ–åŠŸèƒ½
   â”œâ”€â”€ ä¼˜åŒ–å‰ç«¯ç•Œé¢
   â””â”€â”€ æ€§èƒ½ä¼˜åŒ–å’Œæµ‹è¯•
```

### æ³¨æ„äº‹é¡¹

- âš ï¸ **ä¸¥ç¦è·³è¿‡ä»£ç ç”Ÿæˆå™¨ç›´æ¥æ‰‹å†™ä»£ç **ï¼Œé™¤éæœ‰ç‰¹æ®Šä¸šåŠ¡éœ€æ±‚
- âš ï¸ **æ•°æ®åº“è¡¨ç»“æ„è®¾è®¡å¿…é¡»å®Œæ•´**ï¼Œé¿å…åç»­é¢‘ç¹ä¿®æ”¹è¡¨ç»“æ„
- âš ï¸ **ä»£ç ç”Ÿæˆåå¿…é¡»è¿›è¡ŒåŠŸèƒ½æµ‹è¯•**ï¼Œç¡®ä¿åŸºç¡€åŠŸèƒ½æ­£å¸¸
- âš ï¸ **ä¼˜åŒ–ä»£ç æ—¶ä¿æŒä»£ç é£æ ¼ç»Ÿä¸€**ï¼Œéµå¾ªé¡¹ç›®ç¼–ç è§„èŒƒ

---

## ğŸ—ï¸ ç°æœ‰ç³»ç»ŸåŸºç¡€åˆ†æ

### å·²æœ‰æ¨¡å—æ·±åº¦åˆ†æ

**æŠ€æœ¯æ¶æ„ä¼˜åŠ¿ï¼š**
- âœ… Yudaoæ¡†æ¶ï¼šå®Œæ•´çš„RBACæƒé™ä½“ç³» + å¤šç§Ÿæˆ·æ”¯æŒ
- âœ… ä»£ç ç”Ÿæˆå™¨ï¼šå¿«é€Ÿç”ŸæˆCRUDï¼Œæå‡å¼€å‘æ•ˆç‡
- âœ… å·¥ä½œæµå¼•æ“ï¼šActiviti 7ï¼Œæ”¯æŒå¤æ‚æµç¨‹å®¡æ‰¹
- âœ… æ•°æ®åº“ï¼šMySQL 8.0ï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢å’Œäº‹åŠ¡
- âœ… å‰ç«¯ï¼šVue3 + TypeScriptï¼Œç°ä»£åŒ–å¼€å‘ä½“éªŒ

**ç°æœ‰æ•°æ®è¡¨ï¼ˆå·²æ¢³ç†ï¼Œå…±28å¼ ï¼‰ï¼š**
```
é”€å”®æ¨¡å—ï¼ˆ7å¼ ï¼‰ï¼šè®¢å•ã€å‡ºåº“ã€é€€è´§ã€å®¢æˆ·
äº§å“æ¨¡å—ï¼ˆ3å¼ ï¼‰ï¼šäº§å“ã€åˆ†ç±»ã€å•ä½
é‡‡è´­æ¨¡å—ï¼ˆ7å¼ ï¼‰ï¼šè®¢å•ã€å…¥åº“ã€é€€è´§ã€ä¾›åº”å•†
è´¢åŠ¡æ¨¡å—ï¼ˆ5å¼ ï¼‰ï¼šæ”¶æ¬¾ã€ä»˜æ¬¾ã€è´¦æˆ·
åº“å­˜æ¨¡å—ï¼ˆ6å¼ ï¼‰ï¼šåº“å­˜ã€å‡ºå…¥åº“ã€ç›˜ç‚¹ã€è°ƒæ‹¨ã€è®°å½•ã€ä»“åº“
```

**å¾…è¡¥å…¨åŠŸèƒ½ï¼š**
- âš ï¸ ç¼ºå°‘BOMç®¡ç†ï¼ˆç‰©æ–™æ¸…å•ï¼‰
- âš ï¸ ç¼ºå°‘å·¥è‰ºè·¯çº¿ç®¡ç†
- âš ï¸ ç¼ºå°‘ç”Ÿäº§æ’ç¨‹åŠŸèƒ½
- âš ï¸ ç¼ºå°‘è´¨é‡ç®¡ç†ä½“ç³»
- âš ï¸ ç¼ºå°‘æˆæœ¬æ ¸ç®—ä½“ç³»

---

## ğŸ¯ Phase 1: ç”Ÿäº§è®¢å•ç®¡ç† - è¯¦ç»†æ–¹æ¡ˆ

### ğŸ“… æ—¶é—´å®‰æ’ï¼š4å‘¨ï¼ˆ28å¤©ï¼‰

### ğŸ”„ å¼€å‘æµç¨‹

æŒ‰ç…§æ ‡å‡†å¼€å‘æµç¨‹æ‰§è¡Œï¼š

1. **ç¬¬1å‘¨ï¼šæ•°æ®åº“è¡¨ç»“æ„è®¾è®¡ï¼ˆ3å¤©ï¼‰**
   - è®¾è®¡ `erp_production_order` è¡¨ç»“æ„
   - ç¼–å†™SQLè„šæœ¬å¹¶æ‰§è¡Œ
   - éªŒè¯è¡¨ç»“æ„æ­£ç¡®æ€§

2. **ç¬¬1-2å‘¨ï¼šä»£ç ç”Ÿæˆä¸åŸºç¡€åŠŸèƒ½ï¼ˆ5å¤©ï¼‰**
   - ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆç”Ÿäº§è®¢å•ç›¸å…³ä»£ç 
   - æµ‹è¯•åŸºç¡€CRUDåŠŸèƒ½
   - éªŒè¯æƒé™æ§åˆ¶å’Œæ•°æ®æ ¡éªŒ

3. **ç¬¬2-3å‘¨ï¼šä¸šåŠ¡é€»è¾‘å¼€å‘ï¼ˆ10å¤©ï¼‰**
   - å®Œå–„çŠ¶æ€æµè½¬é€»è¾‘
   - å®ç°ç‰©æ–™è½¬åŒ–åŠŸèƒ½
   - æ·»åŠ ä¸šåŠ¡æ ¡éªŒå’Œå¼‚å¸¸å¤„ç†
   - ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½

4. **ç¬¬3-4å‘¨ï¼šå‰ç«¯ä¼˜åŒ–ä¸æµ‹è¯•ï¼ˆ10å¤©ï¼‰**
   - ä¼˜åŒ–å‰ç«¯ç•Œé¢å’Œäº¤äº’
   - æ·»åŠ è‡ªå®šä¹‰ä¸šåŠ¡ç»„ä»¶
   - ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
   - æ€§èƒ½ä¼˜åŒ–å’Œbugä¿®å¤

### ğŸ›ï¸ è¯¦ç»†æ¶æ„è®¾è®¡

#### åç«¯æ¶æ„
```
src/main/java/cn/iocoder/yudao/module/erp/service/production/
â”œâ”€â”€ order/
â”‚   â”œâ”€â”€ ProductionOrderService.java              # ç”Ÿäº§è®¢å•æœåŠ¡
â”‚   â”œâ”€â”€ ProductionOrderItemService.java          # ç”Ÿäº§è®¢å•æ˜ç»†æœåŠ¡
â”‚   â””â”€â”€ MaterialConversionService.java           # ç‰©æ–™è½¬åŒ–æœåŠ¡
â”œâ”€â”€ controller/
â”‚   â”œâ”€â”€ ProductionOrderController.java           # ç”Ÿäº§è®¢å•API
â”‚   â””â”€â”€ MaterialConversionController.java        # ç‰©æ–™è½¬åŒ–API
â””â”€â”€ dal/
    â”œâ”€â”€ ProductionOrderMapper.java               # ç”Ÿäº§è®¢å•Mapper
    â”œâ”€â”€ ProductionOrderItemMapper.java           # æ˜ç»†Mapper
    â””â”€â”€ MaterialConversionMapper.java            # è½¬åŒ–Mapper
```

#### å‰ç«¯æ¶æ„
```
src/views/erp/production/order/
â”œâ”€â”€ index.vue                                    # ç”Ÿäº§è®¢å•åˆ—è¡¨
â”œâ”€â”€ create.vue                                   # åˆ›å»ºç”Ÿäº§è®¢å•
â”œâ”€â”€ detail.vue                                   # ç”Ÿäº§è®¢å•è¯¦æƒ…
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ProductionOrderForm.vue                 # ç”Ÿäº§è®¢å•è¡¨å•
â”‚   â”œâ”€â”€ MaterialConversionForm.vue              # ç‰©æ–™è½¬åŒ–è¡¨å•
â”‚   â””â”€â”€ ProductionOrderStatusFlow.vue           # çŠ¶æ€æµè½¬ç»„ä»¶
â””â”€â”€ api/
    â”œâ”€â”€ order.ts                                 # è®¢å•API
    â””â”€â”€ materialConversion.ts                   # è½¬åŒ–API
```

### ğŸ—„ï¸ æ•°æ®åº“è¯¦ç»†è®¾è®¡

#### 1. erp_production_orderï¼ˆç”Ÿäº§è®¢å•ä¸»è¡¨ï¼‰
```sql
CREATE TABLE erp_production_order (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    no VARCHAR(50) NOT NULL COMMENT 'ç”Ÿäº§è®¢å•å·',
    customer_id BIGINT COMMENT 'å®¢æˆ·IDï¼ˆå…³è”é”€å”®è®¢å•ï¼‰',
    product_id BIGINT NOT NULL COMMENT 'äº§å“ID',
    product_name VARCHAR(255) NOT NULL COMMENT 'äº§å“åç§°',
    product_spec VARCHAR(500) COMMENT 'äº§å“è§„æ ¼',
    unit_id BIGINT COMMENT 'å•ä½ID',
    quantity DECIMAL(20,4) NOT NULL COMMENT 'ç”Ÿäº§æ•°é‡',
    completed_quantity DECIMAL(20,4) DEFAULT 0 COMMENT 'å·²å®Œæˆæ•°é‡',
    start_time DATETIME COMMENT 'è®¡åˆ’å¼€å§‹æ—¶é—´',
    end_time DATETIME COMMENT 'è®¡åˆ’å®Œæˆæ—¶é—´',
    actual_start_time DATETIME COMMENT 'å®é™…å¼€å§‹æ—¶é—´',
    actual_end_time DATETIME COMMENT 'å®é™…å®Œæˆæ—¶é—´',
    status INT NOT NULL COMMENT 'çŠ¶æ€ï¼š1-å¾…å¼€å§‹ï¼Œ2-è¿›è¡Œä¸­ï¼Œ3-å·²æš‚åœï¼Œ4-å·²å®Œæˆï¼Œ5-å·²å–æ¶ˆ',
    priority INT DEFAULT 3 COMMENT 'ä¼˜å…ˆçº§ï¼š1-ç´§æ€¥ï¼Œ2-é«˜ï¼Œ3-ä¸­ï¼Œ4-ä½',
    source_type INT DEFAULT 1 COMMENT 'æ¥æºç±»å‹ï¼š1-æ‰‹åŠ¨åˆ›å»ºï¼Œ2-é”€å”®è®¢å•ï¼Œ3-åº“å­˜è¡¥å……',
    source_id BIGINT COMMENT 'æ¥æºå•æ®ID',
    description TEXT COMMENT 'ç”Ÿäº§è¯´æ˜',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    -- ç´¢å¼•
    INDEX idx_tenant_no (tenant_id, no),
    INDEX idx_status (status),
    INDEX idx_customer (customer_id),
    INDEX idx_product (product_id),
    INDEX idx_create_time (create_time)
) COMMENT='ç”Ÿäº§è®¢å•';
```

#### 2. ç°æœ‰è¡¨å­—æ®µæ‰©å±•
```sql
-- äº§å“è¡¨æ‰©å±•
ALTER TABLE erp_product ADD COLUMN production_type INT DEFAULT 1 COMMENT 'äº§å“ç±»å‹ï¼š1-åŸææ–™ï¼Œ2-åŠæˆå“ï¼Œ3-æˆå“';
ALTER TABLE erp_product ADD COLUMN is_bom TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦æœ‰BOM';

-- ä»“åº“è¡¨æ‰©å±•
ALTER TABLE erp_warehouse ADD COLUMN warehouse_type INT DEFAULT 1 COMMENT 'ä»“åº“ç±»å‹ï¼š1-åŸææ–™ä»“ï¼Œ2-åŠæˆå“ä»“ï¼Œ3-æˆå“ä»“ï¼Œ4-åºŸå“ä»“';

-- é”€å”®è®¢å•è¡¨æ‰©å±•
ALTER TABLE erp_sale_order ADD COLUMN production_status INT DEFAULT 0 COMMENT 'ç”Ÿäº§çŠ¶æ€ï¼š0-æ— éœ€ç”Ÿäº§ï¼Œ1-ç”Ÿäº§ä¸­ï¼Œ2-ç”Ÿäº§å®Œæˆ';

-- é‡‡è´­è®¢å•è¡¨æ‰©å±•
ALTER TABLE erp_purchase_order ADD COLUMN production_order_id BIGINT COMMENT 'å…³è”ç”Ÿäº§è®¢å•ID';

-- åº“å­˜å‡ºå…¥åº“è¡¨æ‰©å±•
ALTER TABLE erp_stock_in ADD COLUMN production_order_id BIGINT COMMENT 'å…³è”ç”Ÿäº§è®¢å•ID';
ALTER TABLE erp_stock_out ADD COLUMN production_order_id BIGINT COMMENT 'å…³è”ç”Ÿäº§è®¢å•ID';
```

### ğŸ”§ æ ¸å¿ƒåŠŸèƒ½å®ç°

#### ç”Ÿäº§è®¢å•çŠ¶æ€æµè½¬
```java
public enum ProductionOrderStatusEnum {
    PENDING(1, "å¾…å¼€å§‹"),
    IN_PROGRESS(2, "è¿›è¡Œä¸­"),
    PAUSED(3, "å·²æš‚åœ"),
    COMPLETED(4, "å·²å®Œæˆ"),
    CANCELLED(5, "å·²å–æ¶ˆ");

    // çŠ¶æ€æµè½¬è§„åˆ™
    private static final Map<Integer, Set<Integer>> STATUS_FLOW = Map.of(
        PENDING.getCode(), Set.of(IN_PROGRESS.getCode(), CANCELLED.getCode()),
        IN_PROGRESS.getCode(), Set.of(PAUSED.getCode(), COMPLETED.getCode(), CANCELLED.getCode()),
        PAUSED.getCode(), Set.of(IN_PROGRESS.getCode(), CANCELLED.getCode())
    );

    public static boolean canTransition(Integer fromStatus, Integer toStatus) {
        return STATUS_FLOW.getOrDefault(fromStatus, Set.of()).contains(toStatus);
    }
}
```

### ğŸ“Š Phase 1 äº¤ä»˜æ¸…å•

#### å¼€å‘æ­¥éª¤æ£€æŸ¥æ¸…å•
- [ ] **æ­¥éª¤1ï¼šæ•°æ®åº“è¡¨ç»“æ„**
  - [ ] è®¾è®¡å¹¶åˆ›å»º `erp_production_order` è¡¨
  - [ ] æ‰§è¡ŒSQLè„šæœ¬éªŒè¯è¡¨ç»“æ„
  - [ ] æ£€æŸ¥ç´¢å¼•å’Œçº¦æŸæ˜¯å¦æ­£ç¡®

- [ ] **æ­¥éª¤2ï¼šä»£ç ç”Ÿæˆ**
  - [ ] ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆç”Ÿäº§è®¢å•åç«¯ä»£ç 
  - [ ] ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆç”Ÿäº§è®¢å•å‰ç«¯ä»£ç 
  - [ ] éªŒè¯åŸºç¡€CRUDåŠŸèƒ½æ­£å¸¸

- [ ] **æ­¥éª¤3ï¼šè°ƒè¯•ä¼˜åŒ–**
  - [ ] å®Œå–„ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€æµè½¬
  - [ ] ä¼˜åŒ–å‰ç«¯ç•Œé¢å’Œäº¤äº’
  - [ ] æ€§èƒ½ä¼˜åŒ–å’Œbugä¿®å¤

#### åç«¯äº¤ä»˜ç‰©
- [ ] ç”Ÿäº§è®¢å•æœåŠ¡å±‚ï¼ˆ15ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼‰
- [ ] ç‰©æ–™è½¬åŒ–æœåŠ¡å±‚ï¼ˆ10ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼‰
- [ ] RESTful APIæ¥å£ï¼ˆ25ä¸ªæ¥å£ï¼‰
- [ ] æ•°æ®åº“è¡¨ç»“æ„å’Œåˆå§‹åŒ–è„šæœ¬
- [ ] å•å…ƒæµ‹è¯•ï¼ˆè¦†ç›–ç‡â‰¥80%ï¼‰
- [ ] é›†æˆæµ‹è¯•ï¼ˆ5ä¸ªæ ¸å¿ƒåœºæ™¯ï¼‰

#### å‰ç«¯äº¤ä»˜ç‰©
- [ ] ç”Ÿäº§è®¢å•åˆ—è¡¨é¡µé¢ï¼ˆæ”¯æŒé«˜çº§æœç´¢ã€çŠ¶æ€ç­›é€‰ï¼‰
- [ ] ç”Ÿäº§è®¢å•åˆ›å»ºé¡µé¢ï¼ˆæ”¯æŒä»é”€å”®è®¢å•è½¬åŒ–ï¼‰
- [ ] ç”Ÿäº§è®¢å•è¯¦æƒ…é¡µé¢ï¼ˆçŠ¶æ€æµè½¬ã€ç‰©æ–™è½¬åŒ–ï¼‰
- [ ] ç‰©æ–™è½¬åŒ–é¡µé¢ï¼ˆæŠ•æ–™ã€äº§å‡ºã€è¿”å·¥ã€æŠ¥åºŸï¼‰
- [ ] ç”Ÿäº§ç»Ÿè®¡æŠ¥è¡¨ï¼ˆè®¢å•å®Œæˆç‡ã€ç‰©æ–™æ¶ˆè€—åˆ†æï¼‰

#### æ–‡æ¡£äº¤ä»˜ç‰©
- [ ] APIæ¥å£æ–‡æ¡£ï¼ˆSwaggerï¼‰
- [ ] æ•°æ®åº“è®¾è®¡æ–‡æ¡£
- [ ] ä¸šåŠ¡æµç¨‹å›¾
- [ ] ç”¨æˆ·æ“ä½œæ‰‹å†Œ
- [ ] éƒ¨ç½²è¿ç»´æ–‡æ¡£

---

## ğŸ¯ Phase 2: ç”Ÿäº§è®¡åˆ’ç®¡ç† - è¯¦ç»†æ–¹æ¡ˆ

### ğŸ“… æ—¶é—´å®‰æ’ï¼š5å‘¨ï¼ˆ35å¤©ï¼‰

### ğŸ¯ æ ¸å¿ƒç›®æ ‡
æ„å»ºæ™ºèƒ½ç”Ÿäº§è®¡åˆ’ä½“ç³»ï¼Œå®ç°ä»BOMåˆ°æ’äº§çš„å…¨æµç¨‹ç®¡ç†

### ğŸ”„ å¼€å‘æµç¨‹

æŒ‰ç…§æ ‡å‡†å¼€å‘æµç¨‹æ‰§è¡Œï¼š

1. **ç¬¬1å‘¨ï¼šæ•°æ®åº“è¡¨ç»“æ„è®¾è®¡ï¼ˆ5å¤©ï¼‰**
   - è®¾è®¡BOMç®¡ç†ç›¸å…³è¡¨ï¼ˆerp_product_bomã€erp_product_bom_itemï¼‰
   - è®¾è®¡å·¥è‰ºè·¯çº¿ç›¸å…³è¡¨ï¼ˆerp_process_routeã€erp_process_route_itemï¼‰
   - è®¾è®¡ç”Ÿäº§æ’ç¨‹ç›¸å…³è¡¨ï¼ˆerp_production_scheduleã€erp_production_schedule_itemï¼‰
   - è®¾è®¡MRPè¿ç®—ç›¸å…³è¡¨ï¼ˆerp_mrp_paramsã€erp_mrp_resultï¼‰
   - ç¼–å†™SQLè„šæœ¬å¹¶æ‰§è¡Œ

2. **ç¬¬2å‘¨ï¼šä»£ç ç”Ÿæˆä¸åŸºç¡€åŠŸèƒ½ï¼ˆ5å¤©ï¼‰**
   - ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”ŸæˆBOMç®¡ç†ç›¸å…³ä»£ç 
   - ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆå·¥è‰ºè·¯çº¿ç®¡ç†ç›¸å…³ä»£ç 
   - ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆç”Ÿäº§æ’ç¨‹ç›¸å…³ä»£ç 
   - æµ‹è¯•åŸºç¡€CRUDåŠŸèƒ½

3. **ç¬¬3-4å‘¨ï¼šä¸šåŠ¡é€»è¾‘å¼€å‘ï¼ˆ14å¤©ï¼‰**
   - å®ç°BOMé€’å½’å±•å¼€ç®—æ³•
   - å®ç°MRPè¿ç®—æ ¸å¿ƒé€»è¾‘
   - å®ç°ç”Ÿäº§æ’ç¨‹ç®—æ³•
   - æ·»åŠ ä¸šåŠ¡æ ¡éªŒå’Œå¼‚å¸¸å¤„ç†

4. **ç¬¬5å‘¨ï¼šå‰ç«¯ä¼˜åŒ–ä¸æµ‹è¯•ï¼ˆ11å¤©ï¼‰**
   - ä¼˜åŒ–å‰ç«¯ç•Œé¢ï¼ˆæ ‘å½¢å±•ç¤ºã€ç”˜ç‰¹å›¾ç­‰ï¼‰
   - æ·»åŠ æ•°æ®å¯è§†åŒ–ç»„ä»¶
   - ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
   - æ€§èƒ½ä¼˜åŒ–å’Œbugä¿®å¤

### ğŸ—„ï¸ æ•°æ®åº“è¯¦ç»†è®¾è®¡

#### 1. BOMç®¡ç†ç›¸å…³è¡¨
```sql
-- BOMä¸»è¡¨
CREATE TABLE erp_product_bom (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    product_id BIGINT NOT NULL COMMENT 'äº§å“ID',
    bom_no VARCHAR(50) NOT NULL COMMENT 'BOMç¼–å·',
    bom_name VARCHAR(255) NOT NULL COMMENT 'BOMåç§°',
    version VARCHAR(20) DEFAULT '1.0' COMMENT 'ç‰ˆæœ¬å·',
    effective_date DATETIME COMMENT 'ç”Ÿæ•ˆæ—¥æœŸ',
    expire_date DATETIME COMMENT 'å¤±æ•ˆæ—¥æœŸ',
    bom_type INT DEFAULT 1 COMMENT 'BOMç±»å‹ï¼š1-ç”Ÿäº§BOMï¼Œ2-è®¾è®¡BOMï¼Œ3-å·¥è‰ºBOM',
    standard_cost DECIMAL(20,2) COMMENT 'æ ‡å‡†æˆæœ¬',
    total_material_cost DECIMAL(20,2) COMMENT 'æ€»ææ–™æˆæœ¬',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-è‰ç¨¿ï¼Œ2-ç”Ÿæ•ˆï¼Œ3-å¤±æ•ˆ',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_product (tenant_id, product_id),
    INDEX idx_bom_no (tenant_id, bom_no),
    INDEX idx_status (status)
) COMMENT='BOMä¸»è¡¨';

-- BOMæ˜ç»†è¡¨
CREATE TABLE erp_product_bom_item (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    bom_id BIGINT NOT NULL COMMENT 'BOM ID',
    parent_product_id BIGINT NOT NULL COMMENT 'çˆ¶äº§å“ID',
    child_product_id BIGINT NOT NULL COMMENT 'å­äº§å“ID',
    child_product_name VARCHAR(255) NOT NULL COMMENT 'å­äº§å“åç§°',
    child_product_spec VARCHAR(500) COMMENT 'å­äº§å“è§„æ ¼',
    unit_id BIGINT COMMENT 'å•ä½ID',
    quantity DECIMAL(20,4) NOT NULL COMMENT 'ç”¨é‡',
    loss_rate DECIMAL(8,4) DEFAULT 0 COMMENT 'æŸè€—ç‡',
    effective_quantity DECIMAL(20,4) GENERATED ALWAYS AS (quantity * (1 + loss_rate)) STORED COMMENT 'æœ‰æ•ˆç”¨é‡',
    is_key_material TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦å…³é”®ç‰©æ–™',
    is_alternative TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦æ›¿ä»£æ–™',
    alternative_group VARCHAR(50) COMMENT 'æ›¿ä»£æ–™ç»„',
    position INT DEFAULT 1 COMMENT 'ä½å·',
    process_id BIGINT COMMENT 'å·¥åºID',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_bom (tenant_id, bom_id),
    INDEX idx_parent (parent_product_id),
    INDEX idx_child (child_product_id),
    INDEX idx_process (process_id)
) COMMENT='BOMæ˜ç»†è¡¨';
```

#### 2. å·¥è‰ºè·¯çº¿ç›¸å…³è¡¨
```sql
-- å·¥è‰ºè·¯çº¿ä¸»è¡¨
CREATE TABLE erp_process_route (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    route_no VARCHAR(50) NOT NULL COMMENT 'å·¥è‰ºè·¯çº¿ç¼–å·',
    route_name VARCHAR(255) NOT NULL COMMENT 'å·¥è‰ºè·¯çº¿åç§°',
    product_id BIGINT NOT NULL COMMENT 'äº§å“ID',
    version VARCHAR(20) DEFAULT '1.0' COMMENT 'ç‰ˆæœ¬å·',
    standard_cycle_time INT COMMENT 'æ ‡å‡†å‘¨æœŸæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰',
    standard_labor_cost DECIMAL(20,2) COMMENT 'æ ‡å‡†äººå·¥æˆæœ¬',
    standard_overhead_cost DECIMAL(20,2) COMMENT 'æ ‡å‡†åˆ¶é€ è´¹ç”¨',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-è‰ç¨¿ï¼Œ2-ç”Ÿæ•ˆï¼Œ3-å¤±æ•ˆ',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_route (tenant_id, route_no),
    INDEX idx_product (product_id),
    INDEX idx_status (status)
) COMMENT='å·¥è‰ºè·¯çº¿ä¸»è¡¨';

-- å·¥è‰ºè·¯çº¿æ˜ç»†è¡¨
CREATE TABLE erp_process_route_item (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    route_id BIGINT NOT NULL COMMENT 'å·¥è‰ºè·¯çº¿ID',
    process_id BIGINT NOT NULL COMMENT 'å·¥åºID',
    sequence INT NOT NULL COMMENT 'åºå·',
    operation_name VARCHAR(255) NOT NULL COMMENT 'å·¥åºåç§°',
    standard_time INT NOT NULL COMMENT 'æ ‡å‡†å·¥æ—¶ï¼ˆåˆ†é’Ÿï¼‰',
    setup_time INT DEFAULT 0 COMMENT 'å‡†å¤‡æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰',
    worker_count INT DEFAULT 1 COMMENT 'äººå‘˜æ•°é‡',
    equipment_id BIGINT COMMENT 'è®¾å¤‡ID',
    work_center_id BIGINT COMMENT 'å·¥ä½œä¸­å¿ƒID',
    labor_rate DECIMAL(10,2) COMMENT 'äººå·¥è´¹ç‡',
    overhead_rate DECIMAL(10,2) COMMENT 'åˆ¶é€ è´¹ç‡',
    is_bottleneck TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦ç“¶é¢ˆå·¥åº',
    quality_check_required TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦éœ€è¦è´¨æ£€',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_route (tenant_id, route_id),
    INDEX idx_process (process_id),
    INDEX idx_equipment (equipment_id),
    INDEX idx_sequence (sequence)
) COMMENT='å·¥è‰ºè·¯çº¿æ˜ç»†è¡¨';
```

#### 3. ç”Ÿäº§æ’ç¨‹ç›¸å…³è¡¨
```sql
-- ç”Ÿäº§æ’ç¨‹ä¸»è¡¨
CREATE TABLE erp_production_schedule (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    schedule_no VARCHAR(50) NOT NULL COMMENT 'æ’ç¨‹å•å·',
    schedule_name VARCHAR(255) NOT NULL COMMENT 'æ’ç¨‹åç§°',
    schedule_type INT DEFAULT 1 COMMENT 'æ’ç¨‹ç±»å‹ï¼š1-ä¸»æ’ç¨‹ï¼Œ2-è¯¦ç»†æ’ç¨‹',
    planning_horizon_days INT DEFAULT 30 COMMENT 'è®¡åˆ’å¤©æ•°',
    start_date DATE NOT NULL COMMENT 'è®¡åˆ’å¼€å§‹æ—¥æœŸ',
    end_date DATE NOT NULL COMMENT 'è®¡åˆ’ç»“æŸæ—¥æœŸ',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-è‰ç¨¿ï¼Œ2-å·²å‘å¸ƒï¼Œ3-æ‰§è¡Œä¸­ï¼Œ4-å·²å®Œæˆ',
    total_orders INT DEFAULT 0 COMMENT 'æ€»è®¢å•æ•°',
    total_quantity DECIMAL(20,4) DEFAULT 0 COMMENT 'æ€»æ•°é‡',
    total_work_hours INT DEFAULT 0 COMMENT 'æ€»å·¥æ—¶',
    created_by VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_by VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_schedule (tenant_id, schedule_no),
    INDEX idx_status (status),
    INDEX idx_date_range (start_date, end_date)
) COMMENT='ç”Ÿäº§æ’ç¨‹ä¸»è¡¨';

-- æ’ç¨‹æ˜ç»†è¡¨
CREATE TABLE erp_production_schedule_item (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    schedule_id BIGINT NOT NULL COMMENT 'æ’ç¨‹ID',
    production_order_id BIGINT NOT NULL COMMENT 'ç”Ÿäº§è®¢å•ID',
    product_id BIGINT NOT NULL COMMENT 'äº§å“ID',
    quantity DECIMAL(20,4) NOT NULL COMMENT 'æ’ç¨‹æ•°é‡',
    planned_start_time DATETIME NOT NULL COMMENT 'è®¡åˆ’å¼€å§‹æ—¶é—´',
    planned_end_time DATETIME NOT NULL COMMENT 'è®¡åˆ’ç»“æŸæ—¶é—´',
    work_center_id BIGINT COMMENT 'å·¥ä½œä¸­å¿ƒID',
    equipment_id BIGINT COMMENT 'è®¾å¤‡ID',
    process_sequence INT COMMENT 'å·¥åºåºå·',
    priority INT DEFAULT 3 COMMENT 'ä¼˜å…ˆçº§',
    setup_time INT DEFAULT 0 COMMENT 'å‡†å¤‡æ—¶é—´',
    run_time INT NOT NULL COMMENT 'è¿è¡Œæ—¶é—´',
    wait_time INT DEFAULT 0 COMMENT 'ç­‰å¾…æ—¶é—´',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-å·²è®¡åˆ’ï¼Œ2-å·²ä¸‹è¾¾ï¼Œ3-è¿›è¡Œä¸­ï¼Œ4-å·²å®Œæˆï¼Œ5-å·²å»¶è¿Ÿ',
    actual_start_time DATETIME COMMENT 'å®é™…å¼€å§‹æ—¶é—´',
    actual_end_time DATETIME COMMENT 'å®é™…ç»“æŸæ—¶é—´',
    completion_rate DECIMAL(5,2) DEFAULT 0 COMMENT 'å®Œæˆç‡',
    delay_reason VARCHAR(500) COMMENT 'å»¶è¿ŸåŸå› ',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_schedule (tenant_id, schedule_id),
    INDEX idx_order (production_order_id),
    INDEX idx_work_center (work_center_id),
    INDEX idx_equipment (equipment_id),
    INDEX idx_time_range (planned_start_time, planned_end_time),
    INDEX idx_status (status)
) COMMENT='ç”Ÿäº§æ’ç¨‹æ˜ç»†è¡¨';
```

#### 4. MRPè¿ç®—ç›¸å…³è¡¨
```sql
-- MRPå‚æ•°è¡¨
CREATE TABLE erp_mrp_params (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    param_name VARCHAR(100) NOT NULL COMMENT 'å‚æ•°åç§°',
    param_code VARCHAR(50) NOT NULL COMMENT 'å‚æ•°ç¼–ç ',
    param_value TEXT NOT NULL COMMENT 'å‚æ•°å€¼',
    param_type INT DEFAULT 1 COMMENT 'å‚æ•°ç±»å‹ï¼š1-å­—ç¬¦ä¸²ï¼Œ2-æ•°å­—ï¼Œ3-æ—¥æœŸï¼Œ4-å¸ƒå°”',
    description VARCHAR(500) COMMENT 'å‚æ•°æè¿°',
    is_system TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦ç³»ç»Ÿå‚æ•°',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_code (tenant_id, param_code),
    INDEX idx_system (is_system)
) COMMENT='MRPå‚æ•°è¡¨';

-- MRPè¿ç®—ç»“æœè¡¨
CREATE TABLE erp_mrp_result (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    run_no VARCHAR(50) NOT NULL COMMENT 'è¿ç®—æ‰¹æ¬¡å·',
    product_id BIGINT NOT NULL COMMENT 'äº§å“ID',
    warehouse_id BIGINT COMMENT 'ä»“åº“ID',
    period_start_date DATE NOT NULL COMMENT 'å‘¨æœŸå¼€å§‹æ—¥æœŸ',
    period_end_date DATE NOT NULL COMMENT 'å‘¨æœŸç»“æŸæ—¥æœŸ',
    gross_requirement DECIMAL(20,4) DEFAULT 0 COMMENT 'æ¯›éœ€æ±‚',
    scheduled_receipts DECIMAL(20,4) DEFAULT 0 COMMENT 'è®¡åˆ’æ¥æ”¶é‡',
    on_hand_inventory DECIMAL(20,4) DEFAULT 0 COMMENT 'ç°æœ‰åº“å­˜',
    net_requirement DECIMAL(20,4) DEFAULT 0 COMMENT 'å‡€éœ€æ±‚',
    planned_order_receipts DECIMAL(20,4) DEFAULT 0 COMMENT 'è®¡åˆ’è®¢å•æ¥æ”¶é‡',
    planned_order_releases DECIMAL(20,4) DEFAULT 0 COMMENT 'è®¡åˆ’è®¢å•å‘æ”¾é‡',
    order_type INT DEFAULT 1 COMMENT 'è®¢å•ç±»å‹ï¼š1-ç”Ÿäº§è®¢å•ï¼Œ2-é‡‡è´­è®¢å•',
    lot_sizing_rule INT DEFAULT 1 COMMENT 'æ‰¹é‡è§„åˆ™ï¼š1-å›ºå®šæ‰¹é‡ï¼Œ2-æŒ‰éœ€ï¼Œ3-æœ€å°-æœ€å¤§',
    lead_time INT DEFAULT 0 COMMENT 'æå‰æœŸï¼ˆå¤©ï¼‰',
    safety_stock DECIMAL(20,4) DEFAULT 0 COMMENT 'å®‰å…¨åº“å­˜',
    order_status INT DEFAULT 1 COMMENT 'è®¢å•çŠ¶æ€ï¼š1-å»ºè®®ï¼Œ2-ç¡®è®¤ï¼Œ3-ä¸‹è¾¾',
    due_date DATE COMMENT 'éœ€æ±‚æ—¥æœŸ',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_tenant_run (tenant_id, run_no),
    INDEX idx_product (product_id),
    INDEX idx_warehouse (warehouse_id),
    INDEX idx_period (period_start_date, period_end_date),
    INDEX idx_due_date (due_date)
) COMMENT='MRPè¿ç®—ç»“æœè¡¨';
```

### ğŸ”§ æ ¸å¿ƒæœåŠ¡å®ç°

#### BOMç®¡ç†æœåŠ¡
```java
@Service
@RequiredArgsConstructor
public class ProductBomServiceImpl implements ProductBomService {

    private final ProductBomMapper bomMapper;
    private final ProductBomItemMapper bomItemMapper;
    private final ProductMapper productMapper;

    /**
     * åˆ›å»ºBOM
     */
    @Override
    @Transactional(rollbackFor = Exception.class)
    public Long createProductBom(ProductBomCreateReqVO createReqVO) {
        // 1. å‚æ•°æ ¡éªŒ
        validateCreateBomParams(createReqVO);

        // 2. ç”ŸæˆBOMç¼–å·
        String bomNo = generateBomNo();

        // 3. åˆ›å»ºBOMä¸»è¡¨
        ProductBomDO bom = ProductBomConvert.INSTANCE.convert(createReqVO);
        bom.setBomNo(bomNo);
        bom.setStatus(ProductBomStatusEnum.DRAFT.getCode());

        // 4. è®¡ç®—æ€»æˆæœ¬
        BigDecimal totalCost = calculateTotalCost(createReqVO.getItems());
        bom.setTotalMaterialCost(totalCost);

        // 5. æ’å…¥ä¸»è¡¨
        bomMapper.insert(bom);

        // 6. åˆ›å»ºBOMæ˜ç»†
        createBomItems(bom.getId(), createReqVO.getItems());

        // 7. æ›´æ–°äº§å“è¡¨BOMæ ‡è¯†
        updateProductBomFlag(createReqVO.getProductId(), true);

        // 8. å‘é€é€šçŸ¥
        sendBomCreateNotification(bom);

        return bom.getId();
    }

    /**
     * BOMå±•å¼€ - é€’å½’å±•å¼€æ‰€æœ‰å­ç‰©æ–™
     */
    @Override
    public List<ProductBomExpandRespVO> expandBom(Long productId, int expandLevel) {
        List<ProductBomExpandRespVO> result = new ArrayList<>();
        expandBomRecursive(productId, 1, expandLevel, new BigDecimal("1"), result);
        return result;
    }

    /**
     * BOMæˆæœ¬è®¡ç®—
     */
    @Override
    public ProductBomCostRespVO calculateBomCost(Long bomId) {
        ProductBomDO bom = validateBomExists(bomId);
        List<ProductBomItemDO> items = bomItemMapper.selectListByBomId(bomId);

        ProductBomCostRespVO costResp = new ProductBomCostRespVO();
        costResp.setBomId(bomId);
        costResp.setBomNo(bom.getBomNo());

        BigDecimal totalMaterialCost = BigDecimal.ZERO;
        BigDecimal totalLaborCost = BigDecimal.ZERO;
        BigDecimal totalOverheadCost = BigDecimal.ZERO;

        for (ProductBomItemDO item : items) {
            ProductBomItemCostVO itemCost = calculateItemCost(item);
            costResp.getItems().add(itemCost);

            totalMaterialCost = totalMaterialCost.add(itemCost.getMaterialCost());
            totalLaborCost = totalLaborCost.add(itemCost.getLaborCost());
            totalOverheadCost = totalOverheadCost.add(itemCost.getOverheadCost());
        }

        costResp.setTotalMaterialCost(totalMaterialCost);
        costResp.setTotalLaborCost(totalLaborCost);
        costResp.setTotalOverheadCost(totalOverheadCost);
        costResp.setTotalCost(totalMaterialCost.add(totalLaborCost).add(totalOverheadCost));

        return costResp;
    }

    /**
     * é€’å½’å±•å¼€BOM
     */
    private void expandBomRecursive(Long productId, int currentLevel, int maxLevel,
                                  BigDecimal parentQuantity, List<ProductBomExpandRespVO> result) {
        if (currentLevel > maxLevel) {
            return;
        }

        ProductDO product = productMapper.selectById(productId);
        if (product == null || !product.getIsBom()) {
            return;
        }

        ProductBomDO bom = bomMapper.selectByProductId(productId);
        if (bom == null) {
            return;
        }

        List<ProductBomItemDO> items = bomItemMapper.selectListByBomId(bom.getId());
        for (ProductBomItemDO item : items) {
            ProductBomExpandRespVO expandVO = ProductBomConvert.INSTANCE.convertExpand(item);
            expandVO.setLevel(currentLevel);
            expandVO.setParentQuantity(parentQuantity);
            expandVO.setTotalQuantity(item.getEffectiveQuantity().multiply(parentQuantity));

            result.add(expandVO);

            // å¦‚æœå­äº§å“ä¹Ÿæœ‰BOMï¼Œç»§ç»­å±•å¼€
            if (currentLevel < maxLevel) {
                expandBomRecursive(item.getChildProductId(), currentLevel + 1, maxLevel,
                                 expandVO.getTotalQuantity(), result);
            }
        }
    }
}
```

#### MRPè¿ç®—æœåŠ¡
```java
@Service
@RequiredArgsConstructor
public class MrpCalculationServiceImpl implements MrpCalculationService {

    private final MrpParamsMapper paramsMapper;
    private final MrpResultMapper resultMapper;
    private final ProductBomService bomService;
    private final StockService stockService;

    /**
     * æ‰§è¡ŒMRPè¿ç®—
     */
    @Override
    @Async("mrpExecutor")
    @Transactional(rollbackFor = Exception.class)
    public MrpCalculationResultVO executeMrpCalculation(MrpCalculationReqVO calculationReqVO) {
        String runNo = generateRunNo();

        try {
            log.info("å¼€å§‹æ‰§è¡ŒMRPè¿ç®—ï¼Œæ‰¹æ¬¡å·ï¼š{}", runNo);

            // 1. è·å–MRPå‚æ•°
            MrpParams params = getMrpParams(calculationReqVO);

            // 2. æ¸…ç†å†å²æ•°æ®
            cleanHistoryData(runNo);

            // 3. è·å–éœ€æ±‚ï¼ˆé”€å”®è®¢å•ã€é¢„æµ‹ç­‰ï¼‰
            List<MrpRequirementDO> requirements = getRequirements(calculationReqVO, params);

            // 4. è·å–åº“å­˜å’Œè®¡åˆ’æ¥æ”¶é‡
            List<MrpInventoryDO> inventories = getInventories(calculationReqVO);

            // 5. æ‰§è¡ŒMRPè¿ç®—
            MrpCalculationResultVO result = executeMrpCore(runNo, requirements, inventories, params);

            // 6. ä¿å­˜è¿ç®—ç»“æœ
            saveMrpResults(runNo, result.getResults());

            // 7. ç”Ÿæˆé‡‡è´­å»ºè®®å’Œç”Ÿäº§è®¡åˆ’
            generateSuggestions(runNo, result.getResults());

            log.info("MRPè¿ç®—å®Œæˆï¼Œæ‰¹æ¬¡å·ï¼š{}ï¼Œè€—æ—¶ï¼š{}ms", runNo, result.getCalculationTime());

            return result;

        } catch (Exception e) {
            log.error("MRPè¿ç®—å¤±è´¥ï¼Œæ‰¹æ¬¡å·ï¼š{}", runNo, e);
            throw new MrpCalculationException("MRPè¿ç®—å¤±è´¥ï¼š" + e.getMessage());
        }
    }

    /**
     * MRPæ ¸å¿ƒè¿ç®—é€»è¾‘
     */
    private MrpCalculationResultVO executeMrpCore(String runNo,
                                                 List<MrpRequirementDO> requirements,
                                                 List<MrpInventoryDO> inventories,
                                                 MrpParams params) {

        long startTime = System.currentTimeMillis();
        List<MrpResultDO> results = new ArrayList<>();

        // æŒ‰äº§å“åˆ†ç»„å¤„ç†éœ€æ±‚
        Map<Long, List<MrpRequirementDO>> requirementByProduct = requirements.stream()
                .collect(Collectors.groupingBy(MrpRequirementDO::getProductId));

        for (Map.Entry<Long, List<MrpRequirementDO>> entry : requirementByProduct.entrySet()) {
            Long productId = entry.getKey();
            List<MrpRequirementDO> productRequirements = entry.getValue();

            // æŒ‰æ—¶é—´æ’åºéœ€æ±‚
            productRequirements.sort(Comparator.comparing(MrpRequirementDO::getDueDate));

            // è·å–åº“å­˜ä¿¡æ¯
            MrpInventoryDO inventory = inventories.stream()
                    .filter(inv -> inv.getProductId().equals(productId))
                    .findFirst()
                    .orElse(new MrpInventoryDO(productId, BigDecimal.ZERO));

            // è®¡ç®—å‡€éœ€æ±‚
            List<MrpResultDO> productResults = calculateNetRequirement(
                    productId, productRequirements, inventory, params);

            results.addAll(productResults);
        }

        // é€’å½’å¤„ç†BOMä¸‹å±‚ç‰©æ–™éœ€æ±‚
        processBomDemands(results, params);

        long endTime = System.currentTimeMillis();

        return MrpCalculationResultVO.builder()
                .runNo(runNo)
                .results(results)
                .calculationTime(endTime - startTime)
                .success(true)
                .build();
    }

    /**
     * è®¡ç®—å‡€éœ€æ±‚
     */
    private List<MrpResultDO> calculateNetRequirement(Long productId,
                                                   List<MrpRequirementDO> requirements,
                                                   MrpInventoryDO inventory,
                                                   MrpParams params) {
        List<MrpResultDO> results = new ArrayList<>();

        BigDecimal onHandInventory = inventory.getOnHandInventory();
        BigDecimal scheduledReceipts = BigDecimal.ZERO;

        for (MrpRequirementDO requirement : requirements) {
            LocalDate periodDate = requirement.getDueDate();

            // è®¡ç®—è¯¥å‘¨æœŸå†…çš„è®¡åˆ’æ¥æ”¶é‡
            BigDecimal periodReceipts = getScheduledReceipts(productId, periodDate);

            // æ¯›éœ€æ±‚ = ç°æœ‰éœ€æ±‚ + è®¡åˆ’æ¥æ”¶é‡
            BigDecimal grossRequirement = requirement.getQuantity().add(periodReceipts);

            // å‡€éœ€æ±‚ = æ¯›éœ€æ±‚ - ç°æœ‰åº“å­˜ - å®‰å…¨åº“å­˜
            BigDecimal safetyStock = getSafetyStock(productId, params);
            BigDecimal netRequirement = grossRequirement.subtract(onHandInventory)
                    .subtract(safetyStock);

            // å¦‚æœå‡€éœ€æ±‚å¤§äº0ï¼Œéœ€è¦è®¡åˆ’è®¢å•
            if (netRequirement.compareTo(BigDecimal.ZERO) > 0) {
                // åº”ç”¨æ‰¹é‡è§„åˆ™
                BigDecimal orderQuantity = applyLotSizingRule(netRequirement, productId, params);

                // åˆ›å»ºè®¡åˆ’è®¢å•æ¥æ”¶
                MrpResultDO plannedReceipt = createMrpResult(
                        runNo, productId, requirement.getWarehouseId(),
                        periodDate, grossRequirement, periodReceipts,
                        onHandInventory, netRequirement, orderQuantity,
                        BigDecimal.ZERO, 1, params);
                results.add(plannedReceipt);

                // åˆ›å»ºè®¡åˆ’è®¢å•å‘æ”¾ï¼ˆè€ƒè™‘æå‰æœŸï¼‰
                LocalDate releaseDate = periodDate.minusDays(getLeadTime(productId, params));
                MrpResultDO plannedRelease = createMrpResult(
                        runNo, productId, requirement.getWarehouseId(),
                        releaseDate, BigDecimal.ZERO, BigDecimal.ZERO,
                        BigDecimal.ZERO, BigDecimal.ZERO, orderQuantity,
                        orderQuantity, 1, params);
                results.add(plannedRelease);

                // æ›´æ–°ç°æœ‰åº“å­˜
                onHandInventory = onHandInventory.add(orderQuantity);
            }

            // æ›´æ–°ç°æœ‰åº“å­˜ï¼ˆå‡å°‘ï¼‰
            onHandInventory = onHandInventory.subtract(requirement.getQuantity());
        }

        return results;
    }
}
```

### ğŸ“Š Phase 2 äº¤ä»˜æ¸…å•

#### å¼€å‘æ­¥éª¤æ£€æŸ¥æ¸…å•
- [ ] **æ­¥éª¤1ï¼šæ•°æ®åº“è¡¨ç»“æ„**
  - [ ] è®¾è®¡å¹¶åˆ›å»ºBOMç®¡ç†ç›¸å…³è¡¨ï¼ˆ2å¼ ï¼‰
  - [ ] è®¾è®¡å¹¶åˆ›å»ºå·¥è‰ºè·¯çº¿ç›¸å…³è¡¨ï¼ˆ2å¼ ï¼‰
  - [ ] è®¾è®¡å¹¶åˆ›å»ºç”Ÿäº§æ’ç¨‹ç›¸å…³è¡¨ï¼ˆ2å¼ ï¼‰
  - [ ] è®¾è®¡å¹¶åˆ›å»ºMRPè¿ç®—ç›¸å…³è¡¨ï¼ˆ2å¼ ï¼‰
  - [ ] æ‰§è¡ŒSQLè„šæœ¬éªŒè¯æ‰€æœ‰è¡¨ç»“æ„

- [ ] **æ­¥éª¤2ï¼šä»£ç ç”Ÿæˆ**
  - [ ] ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”ŸæˆBOMç®¡ç†ä»£ç 
  - [ ] ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆå·¥è‰ºè·¯çº¿ç®¡ç†ä»£ç 
  - [ ] ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆç”Ÿäº§æ’ç¨‹ä»£ç 
  - [ ] éªŒè¯åŸºç¡€CRUDåŠŸèƒ½æ­£å¸¸

- [ ] **æ­¥éª¤3ï¼šè°ƒè¯•ä¼˜åŒ–**
  - [ ] å®ç°BOMé€’å½’å±•å¼€ç®—æ³•
  - [ ] å®ç°MRPè¿ç®—æ ¸å¿ƒé€»è¾‘
  - [ ] å®ç°ç”Ÿäº§æ’ç¨‹ç®—æ³•
  - [ ] ä¼˜åŒ–å‰ç«¯ç•Œé¢å’Œäº¤äº’

#### åç«¯äº¤ä»˜ç‰©
- [ ] BOMç®¡ç†æœåŠ¡ï¼ˆ20ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼‰
- [ ] å·¥è‰ºè·¯çº¿ç®¡ç†æœåŠ¡ï¼ˆ15ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼‰
- [ ] MRPè¿ç®—æœåŠ¡ï¼ˆå¤æ‚ç®—æ³•å®ç°ï¼‰
- [ ] ç”Ÿäº§æ’ç¨‹æœåŠ¡ï¼ˆæ™ºèƒ½æ’ç¨‹ç®—æ³•ï¼‰
- [ ] RESTful APIæ¥å£ï¼ˆ40ä¸ªæ¥å£ï¼‰
- [ ] å¼‚æ­¥MRPè®¡ç®—ï¼ˆSpringå¼‚æ­¥å¤„ç†ï¼‰

#### å‰ç«¯äº¤ä»˜ç‰©
- [ ] BOMç®¡ç†ç•Œé¢ï¼ˆæ ‘å½¢å±•ç¤ºã€æˆæœ¬è®¡ç®—ï¼‰
- [ ] å·¥è‰ºè·¯çº¿ç®¡ç†ç•Œé¢ï¼ˆå·¥åºé…ç½®ã€æ—¶é—´ç®¡ç†ï¼‰
- [ ] MRPè¿ç®—ç•Œé¢ï¼ˆå‚æ•°è®¾ç½®ã€ç»“æœå±•ç¤ºï¼‰
- [ ] ç”Ÿäº§æ’ç¨‹ç•Œé¢ï¼ˆç”˜ç‰¹å›¾ã€èµ„æºè°ƒåº¦ï¼‰
- [ ] ç‰©æ–™éœ€æ±‚åˆ†ææŠ¥è¡¨

#### æŠ€æœ¯äº®ç‚¹
- [ ] BOMé€’å½’å±•å¼€ç®—æ³•ä¼˜åŒ–
- [ ] MRPæ‰¹é‡è®¡ç®—æ€§èƒ½ä¼˜åŒ–ï¼ˆå¼‚æ­¥+åˆ†é¡µï¼‰
- [ ] æ™ºèƒ½æ’ç¨‹ç®—æ³•ï¼ˆçº¦æŸæ»¡è¶³é—®é¢˜ï¼‰
- [ ] å‰ç«¯æ ‘å½¢ç»„ä»¶å’Œç”˜ç‰¹å›¾ç»„ä»¶

---

## ğŸ¯ Phase 3: ç”Ÿäº§æ‰§è¡Œä¸è´¨é‡ç®¡ç† - è¯¦ç»†æ–¹æ¡ˆ

### ğŸ“… æ—¶é—´å®‰æ’ï¼š6å‘¨ï¼ˆ42å¤©ï¼‰

### ğŸ¯ æ ¸å¿ƒç›®æ ‡
å®ç°ç”Ÿäº§è¿‡ç¨‹å®æ—¶ç›‘æ§ã€è´¨é‡ç®¡ç†å’Œè®¾å¤‡ç®¡ç†

### ğŸ”„ å¼€å‘æµç¨‹

æŒ‰ç…§æ ‡å‡†å¼€å‘æµç¨‹æ‰§è¡Œï¼š

1. **ç¬¬1-2å‘¨ï¼šæ•°æ®åº“è¡¨ç»“æ„è®¾è®¡ï¼ˆ7å¤©ï¼‰**
   - è®¾è®¡å·¥å•ç®¡ç†ç›¸å…³è¡¨ï¼ˆerp_work_orderã€erp_work_order_progressï¼‰
   - è®¾è®¡è´¨é‡ç®¡ç†ç›¸å…³è¡¨ï¼ˆerp_quality_standardã€erp_quality_itemã€erp_quality_inspectionç­‰ï¼‰
   - è®¾è®¡è®¾å¤‡ç®¡ç†ç›¸å…³è¡¨ï¼ˆerp_equipmentã€erp_equipment_statusï¼‰
   - ç¼–å†™SQLè„šæœ¬å¹¶æ‰§è¡Œ

2. **ç¬¬2-3å‘¨ï¼šä»£ç ç”Ÿæˆä¸åŸºç¡€åŠŸèƒ½ï¼ˆ7å¤©ï¼‰**
   - ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆå·¥å•ç®¡ç†ç›¸å…³ä»£ç 
   - ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆè´¨é‡ç®¡ç†ç›¸å…³ä»£ç 
   - ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆè®¾å¤‡ç®¡ç†ç›¸å…³ä»£ç 
   - æµ‹è¯•åŸºç¡€CRUDåŠŸèƒ½

3. **ç¬¬3-5å‘¨ï¼šä¸šåŠ¡é€»è¾‘å¼€å‘ï¼ˆ14å¤©ï¼‰**
   - å®ç°å·¥å•çŠ¶æ€æµè½¬å’Œè¿›åº¦ç®¡ç†
   - å®ç°è´¨æ£€æµç¨‹å’Œè´¨é‡æ ‡å‡†ç®¡ç†
   - å®ç°è®¾å¤‡çŠ¶æ€ç›‘æ§å’ŒOEEè®¡ç®—
   - å®ç°WebSocketå®æ—¶æ•°æ®æ¨é€

4. **ç¬¬5-6å‘¨ï¼šå‰ç«¯ä¼˜åŒ–ä¸æµ‹è¯•ï¼ˆ14å¤©ï¼‰**
   - ä¼˜åŒ–å‰ç«¯ç•Œé¢ï¼ˆç”˜ç‰¹å›¾ã€è¿›åº¦è¿½è¸ªç­‰ï¼‰
   - å¼€å‘ç”Ÿäº§ç›‘æ§çœ‹æ¿
   - å¼€å‘ç§»åŠ¨ç«¯APPï¼ˆå¦‚éœ€è¦ï¼‰
   - ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
   - æ€§èƒ½ä¼˜åŒ–å’Œbugä¿®å¤

### ğŸ—„ï¸ æ•°æ®åº“è¯¦ç»†è®¾è®¡

#### 1. å·¥åºç®¡ç†ç›¸å…³è¡¨
```sql
-- å·¥å•ä¸»è¡¨
CREATE TABLE erp_work_order (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    work_order_no VARCHAR(50) NOT NULL COMMENT 'å·¥å•å·',
    production_order_id BIGINT NOT NULL COMMENT 'ç”Ÿäº§è®¢å•ID',
    product_id BIGINT NOT NULL COMMENT 'äº§å“ID',
    product_name VARCHAR(255) NOT NULL COMMENT 'äº§å“åç§°',
    quantity DECIMAL(20,4) NOT NULL COMMENT 'å·¥å•æ•°é‡',
    completed_quantity DECIMAL(20,4) DEFAULT 0 COMMENT 'å®Œæˆæ•°é‡',
    qualified_quantity DECIMAL(20,4) DEFAULT 0 COMMENT 'åˆæ ¼æ•°é‡',
    work_center_id BIGINT NOT NULL COMMENT 'å·¥ä½œä¸­å¿ƒID',
    supervisor_id BIGINT COMMENT 'ä¸»ç®¡ID',
    planned_start_time DATETIME NOT NULL COMMENT 'è®¡åˆ’å¼€å§‹æ—¶é—´',
    planned_end_time DATETIME NOT NULL COMMENT 'è®¡åˆ’ç»“æŸæ—¶é—´',
    actual_start_time DATETIME COMMENT 'å®é™…å¼€å§‹æ—¶é—´',
    actual_end_time DATETIME COMMENT 'å®é™…ç»“æŸæ—¶é—´',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-å·²åˆ›å»ºï¼Œ2-å·²ä¸‹è¾¾ï¼Œ3-è¿›è¡Œä¸­ï¼Œ4-å·²æš‚åœï¼Œ5-å·²å®Œæˆï¼Œ6-å·²å–æ¶ˆ',
    priority INT DEFAULT 3 COMMENT 'ä¼˜å…ˆçº§',
    instruction TEXT COMMENT 'ä½œä¸šæŒ‡å¯¼ä¹¦',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_work_order (tenant_id, work_order_no),
    INDEX idx_production_order (production_order_id),
    INDEX idx_work_center (work_center_id),
    INDEX idx_status (status),
    INDEX idx_time_range (planned_start_time, planned_end_time)
) COMMENT='å·¥å•ä¸»è¡¨';

-- å·¥å•è¿›åº¦è¡¨
CREATE TABLE erp_work_order_progress (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    work_order_id BIGINT NOT NULL COMMENT 'å·¥å•ID',
    process_id BIGINT NOT NULL COMMENT 'å·¥åºID',
    process_name VARCHAR(255) NOT NULL COMMENT 'å·¥åºåç§°',
    sequence INT NOT NULL COMMENT 'å·¥åºåºå·',
    planned_start_time DATETIME COMMENT 'è®¡åˆ’å¼€å§‹æ—¶é—´',
    planned_end_time DATETIME COMMENT 'è®¡åˆ’ç»“æŸæ—¶é—´',
    actual_start_time DATETIME COMMENT 'å®é™…å¼€å§‹æ—¶é—´',
    actual_end_time DATETIME COMMENT 'å®é™…ç»“æŸæ—¶é—´',
    planned_quantity DECIMAL(20,4) COMMENT 'è®¡åˆ’æ•°é‡',
    completed_quantity DECIMAL(20,4) DEFAULT 0 COMMENT 'å®Œæˆæ•°é‡',
    qualified_quantity DECIMAL(20,4) DEFAULT 0 COMMENT 'åˆæ ¼æ•°é‡',
    rejected_quantity DECIMAL(20,4) DEFAULT 0 COMMENT 'ä¸åˆæ ¼æ•°é‡',
    scrap_quantity DECIMAL(20,4) DEFAULT 0 COMMENT 'æŠ¥åºŸæ•°é‡',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-å¾…å¼€å§‹ï¼Œ2-è¿›è¡Œä¸­ï¼Œ3-å·²å®Œæˆï¼Œ4-å¼‚å¸¸',
    operator_id BIGINT COMMENT 'æ“ä½œå‘˜ID',
    equipment_id BIGINT COMMENT 'è®¾å¤‡ID',
    work_time INT DEFAULT 0 COMMENT 'å®é™…å·¥æ—¶ï¼ˆåˆ†é’Ÿï¼‰',
    downtime INT DEFAULT 0 COMMENT 'åœæœºæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰',
    quality_status INT DEFAULT 1 COMMENT 'è´¨æ£€çŠ¶æ€ï¼š1-å¾…æ£€ï¼Œ2-åˆæ ¼ï¼Œ3-ä¸åˆæ ¼',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    INDEX idx_tenant_work_order (tenant_id, work_order_id),
    INDEX idx_process (process_id),
    INDEX idx_operator (operator_id),
    INDEX idx_equipment (equipment_id),
    INDEX idx_status (status)
) COMMENT='å·¥å•è¿›åº¦è¡¨';
```

#### 2. è´¨é‡ç®¡ç†ç›¸å…³è¡¨
```sql
-- è´¨æ£€æ ‡å‡†è¡¨
CREATE TABLE erp_quality_standard (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    standard_no VARCHAR(50) NOT NULL COMMENT 'æ ‡å‡†ç¼–å·',
    standard_name VARCHAR(255) NOT NULL COMMENT 'æ ‡å‡†åç§°',
    product_id BIGINT NOT NULL COMMENT 'äº§å“ID',
    process_id BIGINT COMMENT 'å·¥åºID',
    inspection_type INT DEFAULT 1 COMMENT 'æ£€éªŒç±»å‹ï¼š1-è¿›æ–™æ£€éªŒï¼Œ2-è¿‡ç¨‹æ£€éªŒï¼Œ3-æˆå“æ£€éªŒ',
    standard_version VARCHAR(20) DEFAULT '1.0' COMMENT 'æ ‡å‡†ç‰ˆæœ¬',
    aql_level VARCHAR(10) COMMENT 'AQLæ°´å¹³',
    sampling_method VARCHAR(100) COMMENT 'æŠ½æ ·æ–¹æ³•',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-è‰ç¨¿ï¼Œ2-ç”Ÿæ•ˆï¼Œ3-å¤±æ•ˆ',
    description TEXT COMMENT 'æ ‡å‡†æè¿°',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_standard (tenant_id, standard_no),
    INDEX idx_product (product_id),
    INDEX idx_process (process_id),
    INDEX idx_status (status)
) COMMENT='è´¨æ£€æ ‡å‡†è¡¨';

-- è´¨æ£€é¡¹ç›®è¡¨
CREATE TABLE erp_quality_item (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    standard_id BIGINT NOT NULL COMMENT 'æ ‡å‡†ID',
    item_no VARCHAR(50) NOT NULL COMMENT 'é¡¹ç›®ç¼–å·',
    item_name VARCHAR(255) NOT NULL COMMENT 'é¡¹ç›®åç§°',
    item_type INT DEFAULT 1 COMMENT 'é¡¹ç›®ç±»å‹ï¼š1-å®šæ€§ï¼Œ2-å®šé‡',
    test_method VARCHAR(500) COMMENT 'æ£€éªŒæ–¹æ³•',
    standard_value VARCHAR(500) COMMENT 'æ ‡å‡†å€¼',
    tolerance VARCHAR(100) COMMENT 'å…¬å·®èŒƒå›´',
    unit VARCHAR(20) COMMENT 'å•ä½',
    is_key_item TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦å…³é”®é¡¹',
    sequence INT DEFAULT 1 COMMENT 'æ£€éªŒåºå·',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_standard (tenant_id, standard_id),
    INDEX idx_key_item (is_key_item),
    INDEX idx_sequence (sequence)
) COMMENT='è´¨æ£€é¡¹ç›®è¡¨';

-- è´¨æ£€è®°å½•è¡¨
CREATE TABLE erp_quality_inspection (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    inspection_no VARCHAR(50) NOT NULL COMMENT 'æ£€éªŒå•å·',
    batch_no VARCHAR(50) COMMENT 'æ‰¹æ¬¡å·',
    product_id BIGINT NOT NULL COMMENT 'äº§å“ID',
    process_id BIGINT COMMENT 'å·¥åºID',
    work_order_id BIGINT COMMENT 'å·¥å•ID',
    inspection_type INT DEFAULT 1 COMMENT 'æ£€éªŒç±»å‹ï¼š1-è¿›æ–™æ£€éªŒï¼Œ2-è¿‡ç¨‹æ£€éªŒï¼Œ3-æˆå“æ£€éªŒ',
    inspection_level INT DEFAULT 1 COMMENT 'æ£€éªŒçº§åˆ«ï¼š1-å…¨æ£€ï¼Œ2-æŠ½æ£€',
    lot_size INT COMMENT 'æ‰¹é‡å¤§å°',
    sample_size INT COMMENT 'æ ·æœ¬æ•°é‡',
    qualified_quantity INT DEFAULT 0 COMMENT 'åˆæ ¼æ•°é‡',
    rejected_quantity INT DEFAULT 0 COMMENT 'ä¸åˆæ ¼æ•°é‡',
    scrap_quantity INT DEFAULT 0 COMMENT 'æŠ¥åºŸæ•°é‡',
    inspection_result INT DEFAULT 1 COMMENT 'æ£€éªŒç»“æœï¼š1-åˆæ ¼ï¼Œ2-ä¸åˆæ ¼ï¼Œ3-å¾…å¤æ£€',
    inspector_id BIGINT COMMENT 'æ£€éªŒå‘˜ID',
    inspection_time DATETIME NOT NULL COMMENT 'æ£€éªŒæ—¶é—´',
    environment VARCHAR(200) COMMENT 'æ£€éªŒç¯å¢ƒ',
    equipment VARCHAR(200) COMMENT 'æ£€éªŒè®¾å¤‡',
    remark TEXT COMMENT 'æ£€éªŒå¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_inspection (tenant_id, inspection_no),
    INDEX idx_batch_no (batch_no),
    INDEX idx_product (product_id),
    INDEX idx_work_order (work_order_id),
    INDEX idx_inspection_time (inspection_time)
) COMMENT='è´¨æ£€è®°å½•è¡¨';

-- è´¨æ£€æ˜ç»†è¡¨
CREATE TABLE erp_quality_inspection_item (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    inspection_id BIGINT NOT NULL COMMENT 'æ£€éªŒID',
    item_id BIGINT NOT NULL COMMENT 'æ£€éªŒé¡¹ç›®ID',
    sample_no VARCHAR(50) COMMENT 'æ ·æœ¬ç¼–å·',
    measured_value VARCHAR(500) COMMENT 'æµ‹é‡å€¼',
    actual_value DECIMAL(20,6) COMMENT 'å®é™…æ•°å€¼',
    test_result INT DEFAULT 1 COMMENT 'æ£€éªŒç»“æœï¼š1-åˆæ ¼ï¼Œ2-ä¸åˆæ ¼ï¼Œ3-è¶…å·®',
    defect_type VARCHAR(100) COMMENT 'ç¼ºé™·ç±»å‹',
    defect_description VARCHAR(500) COMMENT 'ç¼ºé™·æè¿°',
    image_urls TEXT COMMENT 'ç¼ºé™·å›¾ç‰‡URLs',
    inspector_id BIGINT COMMENT 'æ£€éªŒå‘˜ID',
    inspection_time DATETIME NOT NULL COMMENT 'æ£€éªŒæ—¶é—´',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    INDEX idx_tenant_inspection (tenant_id, inspection_id),
    INDEX idx_item (item_id),
    INDEX inspector (inspector_id),
    INDEX idx_result (test_result)
) COMMENT='è´¨æ£€æ˜ç»†è¡¨';
```

#### 3. è®¾å¤‡ç®¡ç†ç›¸å…³è¡¨
```sql
-- è®¾å¤‡å°è´¦è¡¨
CREATE TABLE erp_equipment (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    equipment_no VARCHAR(50) NOT NULL COMMENT 'è®¾å¤‡ç¼–å·',
    equipment_name VARCHAR(255) NOT NULL COMMENT 'è®¾å¤‡åç§°',
    equipment_type VARCHAR(100) COMMENT 'è®¾å¤‡ç±»å‹',
    model VARCHAR(100) COMMENT 'è®¾å¤‡å‹å·',
    manufacturer VARCHAR(255) COMMENT 'åˆ¶é€ å•†',
    serial_number VARCHAR(100) COMMENT 'åºåˆ—å·',
    purchase_date DATE COMMENT 'è´­ç½®æ—¥æœŸ',
    purchase_price DECIMAL(20,2) COMMENT 'è´­ç½®ä»·æ ¼',
    service_life INT COMMENT 'è®¾è®¡å¯¿å‘½ï¼ˆå¹´ï¼‰',
    work_center_id BIGINT COMMENT 'å·¥ä½œä¸­å¿ƒID',
    location VARCHAR(200) COMMENT 'è®¾å¤‡ä½ç½®',
    capacity DECIMAL(20,4) COMMENT 'äº§èƒ½ï¼ˆå°æ—¶/å¤©ï¼‰',
    efficiency_rate DECIMAL(5,2) DEFAULT 100 COMMENT 'æ•ˆç‡ç³»æ•°',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-æ­£å¸¸ï¼Œ2-ç»´ä¿®ä¸­ï¼Œ3-æ•…éšœï¼Œ4-æŠ¥åºŸ',
    responsible_person VARCHAR(64) COMMENT 'è´£ä»»äºº',
    specification TEXT COMMENT 'æŠ€æœ¯è§„æ ¼',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_equipment (tenant_id, equipment_no),
    INDEX idx_type (equipment_type),
    INDEX idx_work_center (work_center_id),
    INDEX idx_status (status)
) COMMENT='è®¾å¤‡å°è´¦è¡¨';

-- è®¾å¤‡çŠ¶æ€è®°å½•è¡¨
CREATE TABLE erp_equipment_status (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    equipment_id BIGINT NOT NULL COMMENT 'è®¾å¤‡ID',
    status INT NOT NULL COMMENT 'çŠ¶æ€ï¼š1-è¿è¡Œï¼Œ2-å¾…æœºï¼Œ3-æ•…éšœï¼Œ4-ç»´ä¿®ï¼Œ5-åœæœº',
    status_start_time DATETIME NOT NULL COMMENT 'çŠ¶æ€å¼€å§‹æ—¶é—´',
    status_end_time DATETIME COMMENT 'çŠ¶æ€ç»“æŸæ—¶é—´',
    duration INT COMMENT 'æŒç»­æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰',
    work_order_id BIGINT COMMENT 'å…³è”å·¥å•ID',
    operator_id BIGINT COMMENT 'æ“ä½œå‘˜ID',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_tenant_equipment (tenant_id, equipment_id),
    INDEX idx_status (status),
    INDEX idx_time_range (status_start_time, status_end_time),
    INDEX idx_work_order (work_order_id)
) COMMENT='è®¾å¤‡çŠ¶æ€è®°å½•è¡¨';
```

### ğŸ”§ æ ¸å¿ƒæœåŠ¡å®ç°

#### å·¥å•ç®¡ç†æœåŠ¡
```java
@Service
@RequiredArgsConstructor
public class WorkOrderServiceImpl implements WorkOrderService {

    private final WorkOrderMapper workOrderMapper;
    private final WorkOrderProgressMapper progressMapper;
    private final ProductionOrderService productionOrderService;
    private final MessageService messageService;

    /**
     * åˆ›å»ºå·¥å•
     */
    @Override
    @Transactional(rollbackFor = Exception.class)
    public Long createWorkOrder(WorkOrderCreateReqVO createReqVO) {
        // 1. å‚æ•°æ ¡éªŒ
        validateCreateWorkOrderParams(createReqVO);

        // 2. ç”Ÿæˆå·¥å•å·
        String workOrderNo = generateWorkOrderNo();

        // 3. åˆ›å»ºå·¥å•ä¸»è¡¨
        WorkOrderDO workOrder = WorkOrderConvert.INSTANCE.convert(createReqVO);
        workOrder.setWorkOrderNo(workOrderNo);
        workOrder.setStatus(WorkOrderStatusEnum.CREATED.getCode());

        // 4. æ’å…¥å·¥å•
        workOrderMapper.insert(workOrder);

        // 5. åˆ›å»ºå·¥å•å·¥åºè¿›åº¦
        createWorkOrderProgress(workOrder.getId(), createReqVO);

        // 6. å‘é€å·¥å•åˆ›å»ºé€šçŸ¥
        sendWorkOrderNotification(workOrder, "å·¥å•å·²åˆ›å»º");

        return workOrder.getId();
    }

    /**
     * å¼€å§‹å·¥å•ç”Ÿäº§
     */
    @Override
    @Transactional(rollbackFor = Exception.class)
    public void startWorkOrder(Long workOrderId, WorkOrderStartReqVO startReqVO) {
        WorkOrderDO workOrder = validateWorkOrder(workOrderId);

        // 1. çŠ¶æ€æ ¡éªŒ
        if (!WorkOrderStatusEnum.ISSUED.getCode().equals(workOrder.getStatus())) {
            throw exception(WORK_ORDER_STATUS_ERROR);
        }

        // 2. æ£€æŸ¥è®¾å¤‡çŠ¶æ€
        checkEquipmentStatus(startReqVO.getEquipmentId());

        // 3. æ£€æŸ¥ç‰©æ–™çŠ¶æ€
        checkMaterialAvailability(workOrderId);

        // 4. æ›´æ–°å·¥å•çŠ¶æ€
        WorkOrderDO updateDO = new WorkOrderDO();
        updateDO.setId(workOrderId);
        updateDO.setStatus(WorkOrderStatusEnum.IN_PROGRESS.getCode());
        updateDO.setActualStartTime(LocalDateTime.now());
        workOrderMapper.updateById(updateDO);

        // 5. å¼€å§‹ç¬¬ä¸€é“å·¥åº
        startFirstProcess(workOrderId, startReqVO);

        // 6. æ›´æ–°è®¾å¤‡çŠ¶æ€
        updateEquipmentStatus(startReqVO.getEquipmentId(), EquipmentStatusEnum.RUNNING);

        // 7. å‘é€å¼€å§‹ç”Ÿäº§é€šçŸ¥
        sendWorkOrderNotification(workOrder, "å·¥å•å·²å¼€å§‹ç”Ÿäº§");
    }

    /**
     * å®Œæˆå·¥åº
     */
    @Override
    @Transactional(rollbackFor = Exception.class)
    public void completeProcess(Long workOrderId, Long processId, WorkOrderProcessCompleteReqVO completeReqVO) {
        // 1. è·å–å·¥å•å’Œå·¥åºè¿›åº¦
        WorkOrderDO workOrder = validateWorkOrder(workOrderId);
        WorkOrderProgressDO progress = getWorkOrderProgress(workOrderId, processId);

        // 2. è´¨é‡æ£€éªŒï¼ˆå¦‚æœéœ€è¦ï¼‰
        if (completeReqVO.getRequireQualityCheck()) {
            performQualityCheck(workOrderId, processId, completeReqVO.getQualityData());
        }

        // 3. æ›´æ–°å·¥åºè¿›åº¦
        updateProcessProgress(progress, completeReqVO);

        // 4. ç‰©æ–™æ¶ˆè€—è®°å½•
        recordMaterialConsumption(workOrderId, processId, completeReqVO.getMaterialConsumption());

        // 5. åˆ¤æ–­æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€é“å·¥åº
        WorkOrderProgressDO nextProcess = getNextProcess(workOrderId, processId);
        if (nextProcess != null) {
            // å¼€å§‹ä¸‹ä¸€é“å·¥åº
            startNextProcess(nextProcess, completeReqVO);
        } else {
            // æ‰€æœ‰å·¥åºå®Œæˆï¼Œå®Œæˆå·¥å•
            completeWorkOrder(workOrderId);
        }

        // 6. æ›´æ–°è®¾å¤‡çŠ¶æ€
        if (completeReqVO.getEquipmentId() != null) {
            updateEquipmentStatus(completeReqVO.getEquipmentId(), EquipmentStatusEnum.IDLE);
        }

        // 7. å‘é€è¿›åº¦æ›´æ–°é€šçŸ¥
        sendProgressUpdateNotification(workOrder, progress);
    }

    /**
     * å®æ—¶è¿›åº¦æ›´æ–°
     */
    @Override
    @Async("workOrderExecutor")
    public void updateRealTimeProgress(Long workOrderId, Long processId,
                                     BigDecimal currentQuantity, String status) {
        // 1. è·å–å·¥å•è¿›åº¦
        WorkOrderProgressDO progress = getWorkOrderProgress(workOrderId, processId);

        // 2. æ›´æ–°å®æ—¶è¿›åº¦
        progress.setCompletedQuantity(currentQuantity);
        progress.setUpdateTime(LocalDateTime.now());

        // 3. æ ¹æ®çŠ¶æ€æ›´æ–°å…¶ä»–å­—æ®µ
        switch (status) {
            case "RUNNING":
                progress.setStatus(WorkOrderProcessStatusEnum.IN_PROGRESS.getCode());
                break;
            case "PAUSED":
                progress.setStatus(WorkOrderProcessStatusEnum.PAUSED.getCode());
                break;
            case "ERROR":
                progress.setStatus(WorkOrderProcessStatusEnum.ERROR.getCode());
                break;
        }

        progressMapper.updateById(progress);

        // 4. é€šè¿‡WebSocketæ¨é€å®æ—¶æ•°æ®
        webSocketService.sendToTopic("/work-order/progress/" + workOrderId,
                                   Map.of("processId", processId,
                                         "quantity", currentQuantity,
                                         "status", status));
    }
}
```

### ğŸ“Š Phase 3 äº¤ä»˜æ¸…å•

#### å¼€å‘æ­¥éª¤æ£€æŸ¥æ¸…å•
- [ ] **æ­¥éª¤1ï¼šæ•°æ®åº“è¡¨ç»“æ„**
  - [ ] è®¾è®¡å¹¶åˆ›å»ºå·¥å•ç®¡ç†ç›¸å…³è¡¨ï¼ˆ2å¼ ï¼‰
  - [ ] è®¾è®¡å¹¶åˆ›å»ºè´¨é‡ç®¡ç†ç›¸å…³è¡¨ï¼ˆ4å¼ ï¼‰
  - [ ] è®¾è®¡å¹¶åˆ›å»ºè®¾å¤‡ç®¡ç†ç›¸å…³è¡¨ï¼ˆ2å¼ ï¼‰
  - [ ] æ‰§è¡ŒSQLè„šæœ¬éªŒè¯æ‰€æœ‰è¡¨ç»“æ„

- [ ] **æ­¥éª¤2ï¼šä»£ç ç”Ÿæˆ**
  - [ ] ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆå·¥å•ç®¡ç†ä»£ç 
  - [ ] ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆè´¨é‡ç®¡ç†ä»£ç 
  - [ ] ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆè®¾å¤‡ç®¡ç†ä»£ç 
  - [ ] éªŒè¯åŸºç¡€CRUDåŠŸèƒ½æ­£å¸¸

- [ ] **æ­¥éª¤3ï¼šè°ƒè¯•ä¼˜åŒ–**
  - [ ] å®ç°å·¥å•çŠ¶æ€æµè½¬å’Œè¿›åº¦ç®¡ç†
  - [ ] å®ç°è´¨æ£€æµç¨‹å’Œè´¨é‡æ ‡å‡†ç®¡ç†
  - [ ] å®ç°è®¾å¤‡çŠ¶æ€ç›‘æ§å’ŒOEEè®¡ç®—
  - [ ] å®ç°WebSocketå®æ—¶æ•°æ®æ¨é€
  - [ ] å¼€å‘ç”Ÿäº§ç›‘æ§çœ‹æ¿

#### åç«¯äº¤ä»˜ç‰©
- [ ] å·¥å•ç®¡ç†æœåŠ¡ï¼ˆ20ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼‰
- [ ] è´¨é‡ç®¡ç†æœåŠ¡ï¼ˆ25ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼‰
- [ ] è®¾å¤‡ç®¡ç†æœåŠ¡ï¼ˆ15ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼‰
- [ ] ç”Ÿäº§ç›‘æ§æœåŠ¡ï¼ˆå®æ—¶æ•°æ®é‡‡é›†ï¼‰
- [ ] WebSocketå®æ—¶æ¨é€æœåŠ¡
- [ ] RESTful APIæ¥å£ï¼ˆ60ä¸ªæ¥å£ï¼‰

#### å‰ç«¯äº¤ä»˜ç‰©
- [ ] å·¥å•ç®¡ç†ç•Œé¢ï¼ˆç”˜ç‰¹å›¾ã€è¿›åº¦è¿½è¸ªï¼‰
- [ ] è´¨æ£€ç®¡ç†ç•Œé¢ï¼ˆæŠ½æ£€æ–¹æ¡ˆã€è®°å½•å½•å…¥ï¼‰
- [ ] è®¾å¤‡ç®¡ç†ç•Œé¢ï¼ˆOEEè®¡ç®—ã€ç»´æŠ¤è®¡åˆ’ï¼‰
- [ ] ç”Ÿäº§ç›‘æ§çœ‹æ¿ï¼ˆå¤§å±å±•ç¤ºã€å®æ—¶æ•°æ®ï¼‰
- [ ] ç§»åŠ¨ç«¯APPï¼ˆå·¥åºç¡®è®¤ã€è´¨æ£€å½•å…¥ï¼‰

#### æŠ€æœ¯äº®ç‚¹
- [ ] WebSocketå®æ—¶æ•°æ®æ¨é€
- [ ] è´¨æ£€æ•°æ®ç»Ÿè®¡åˆ†æç®—æ³•
- [ ] è®¾å¤‡OEEå®æ—¶è®¡ç®—
- [ ] å‰ç«¯å®æ—¶å›¾è¡¨å’Œè¿›åº¦æ¡ç»„ä»¶

---

## ğŸ¯ Phase 4: æˆæœ¬æ ¸ç®—ä¸æ•°æ®åˆ†æ - è¯¦ç»†æ–¹æ¡ˆ

### ğŸ“… æ—¶é—´å®‰æ’ï¼š5å‘¨ï¼ˆ35å¤©ï¼‰

### ğŸ¯ æ ¸å¿ƒç›®æ ‡
æ„å»ºå®Œæ•´çš„ç”Ÿäº§æˆæœ¬æ ¸ç®—ä½“ç³»ä¸æ•°æ®åˆ†æå¹³å°

### ğŸ”„ å¼€å‘æµç¨‹

æŒ‰ç…§æ ‡å‡†å¼€å‘æµç¨‹æ‰§è¡Œï¼š

1. **ç¬¬1å‘¨ï¼šæ•°æ®åº“è¡¨ç»“æ„è®¾è®¡ï¼ˆ5å¤©ï¼‰**
   - è®¾è®¡æˆæœ¬æ ¸ç®—ç›¸å…³è¡¨ï¼ˆerp_cost_standardã€erp_cost_actualã€erp_cost_varianceã€erp_work_hoursï¼‰
   - è®¾è®¡ç”Ÿäº§æ•°æ®åˆ†æç›¸å…³è¡¨ï¼ˆerp_production_kpiã€erp_production_reportã€erp_production_dashboard_configï¼‰
   - ç¼–å†™SQLè„šæœ¬å¹¶æ‰§è¡Œ

2. **ç¬¬2å‘¨ï¼šä»£ç ç”Ÿæˆä¸åŸºç¡€åŠŸèƒ½ï¼ˆ5å¤©ï¼‰**
   - ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆæˆæœ¬æ ¸ç®—ç›¸å…³ä»£ç 
   - ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆç”Ÿäº§æ•°æ®åˆ†æç›¸å…³ä»£ç 
   - æµ‹è¯•åŸºç¡€CRUDåŠŸèƒ½

3. **ç¬¬3-4å‘¨ï¼šä¸šåŠ¡é€»è¾‘å¼€å‘ï¼ˆ14å¤©ï¼‰**
   - å®ç°æˆæœ¬æ ¸ç®—ç®—æ³•ï¼ˆææ–™æˆæœ¬ã€äººå·¥æˆæœ¬ã€åˆ¶é€ è´¹ç”¨ï¼‰
   - å®ç°æˆæœ¬å·®å¼‚åˆ†æé€»è¾‘
   - å®ç°ç”Ÿäº§KPIè®¡ç®—å’ŒæŠ¥è¡¨ç”Ÿæˆ
   - å®ç°æ•°æ®å¯è§†åŒ–æ•°æ®å¤„ç†

4. **ç¬¬5å‘¨ï¼šå‰ç«¯ä¼˜åŒ–ä¸æµ‹è¯•ï¼ˆ11å¤©ï¼‰**
   - ä¼˜åŒ–å‰ç«¯ç•Œé¢ï¼ˆæˆæœ¬æ ¸ç®—ã€æŠ¥è¡¨å±•ç¤ºç­‰ï¼‰
   - å¼€å‘æ•°æ®çœ‹æ¿ç•Œé¢
   - æ·»åŠ æ•°æ®å¯è§†åŒ–å›¾è¡¨
   - ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
   - æ€§èƒ½ä¼˜åŒ–å’Œbugä¿®å¤

### ğŸ—„ï¸ æ•°æ®ï¿½ï¿½è¯¦ï¿½ï¿½è®¾è®¡

#### 1. æˆæœ¬æ ¸ç®—ç›¸å…³è¡¨
```sql
-- æ ‡å‡†æˆæœ¬è¡¨
CREATE TABLE erp_cost_standard (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    product_id BIGINT NOT NULL COMMENT 'äº§å“ID',
    version VARCHAR(20) DEFAULT '1.0' COMMENT 'ç‰ˆæœ¬å·',
    effective_date DATETIME NOT NULL COMMENT 'ç”Ÿæ•ˆæ—¥æœŸ',
    expire_date DATETIME COMMENT 'å¤±æ•ˆæ—¥æœŸ',
    material_cost DECIMAL(20,2) NOT NULL DEFAULT 0 COMMENT 'ææ–™æˆæœ¬',
    labor_cost DECIMAL(20,2) NOT NULL DEFAULT 0 COMMENT 'äººå·¥æˆæœ¬',
    overhead_cost DECIMAL(20,2) NOT NULL DEFAULT 0 COMMENT 'åˆ¶é€ è´¹ç”¨',
    total_cost DECIMAL(20,2) NOT NULL DEFAULT 0 COMMENT 'æ€»æˆæœ¬',
    cost_currency VARCHAR(10) DEFAULT 'CNY' COMMENT 'æˆæœ¬å¸ç§',
    calculation_date DATETIME NOT NULL COMMENT 'è®¡ç®—æ—¥æœŸ',
    bom_version VARCHAR(20) COMMENT 'å…³è”BOMç‰ˆæœ¬',
    route_version VARCHAR(20) COMMENT 'å…³è”å·¥è‰ºç‰ˆæœ¬',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-è‰ç¨¿ï¼Œ2-ç”Ÿæ•ˆï¼Œ3-å¤±æ•ˆ',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_product (tenant_id, product_id),
    INDEX idx_effective_date (effective_date),
    INDEX idx_status (status)
) COMMENT='æ ‡å‡†æˆæœ¬è¡¨';

-- å®é™…æˆæœ¬è¡¨
CREATE TABLE erp_cost_actual (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    cost_no VARCHAR(50) NOT NULL COMMENT 'æˆæœ¬å•å·',
    work_order_id BIGINT COMMENT 'å·¥å•ID',
    production_order_id BIGINT COMMENT 'ç”Ÿäº§è®¢å•ID',
    product_id BIGINT NOT NULL COMMENT 'äº§å“ID',
    production_quantity DECIMAL(20,4) NOT NULL COMMENT 'ç”Ÿäº§æ•°é‡',
    material_cost DECIMAL(20,2) NOT NULL DEFAULT 0 COMMENT 'ææ–™æˆæœ¬',
    material_cost_adjust DECIMAL(20,2) DEFAULT 0 COMMENT 'ææ–™æˆæœ¬è°ƒæ•´',
    labor_cost DECIMAL(20,2) NOT NULL DEFAULT 0 COMMENT 'äººå·¥æˆæœ¬',
    labor_cost_adjust DECIMAL(20,2) DEFAULT 0 COMMENT 'äººå·¥æˆæœ¬è°ƒæ•´',
    overhead_cost DECIMAL(20,2) NOT NULL DEFAULT 0 COMMENT 'åˆ¶é€ è´¹ç”¨',
    overhead_cost_adjust DECIMAL(20,2) DEFAULT 0 COMMENT 'åˆ¶é€ è´¹ç”¨è°ƒæ•´',
    total_cost DECIMAL(20,2) NOT NULL DEFAULT 0 COMMENT 'æ€»æˆæœ¬',
    unit_cost DECIMAL(20,4) NOT NULL DEFAULT 0 COMMENT 'å•ä½æˆæœ¬',
    cost_currency VARCHAR(10) DEFAULT 'CNY' COMMENT 'æˆæœ¬å¸ç§',
    cost_period VARCHAR(20) NOT NULL COMMENT 'æˆæœ¬æœŸé—´ï¼ˆYYYY-MMï¼‰',
    calculation_date DATETIME NOT NULL COMMENT 'è®¡ç®—æ—¥æœŸ',
    last_adjust_date DATETIME COMMENT 'æœ€åè°ƒæ•´æ—¥æœŸ',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-è‰ç¨¿ï¼Œ2-å·²è®¡ç®—ï¼Œ3-å·²ç¡®è®¤',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_cost (tenant_id, cost_no),
    INDEX idx_work_order (work_order_id),
    INDEX idx_production_order (production_order_id),
    INDEX idx_cost_period (cost_period),
    INDEX idx_status (status)
) COMMENT='å®é™…æˆæœ¬è¡¨';

-- æˆæœ¬å·®å¼‚åˆ†æè¡¨
CREATE TABLE erp_cost_variance (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    cost_actual_id BIGINT NOT NULL COMMENT 'å®é™…æˆæœ¬ID',
    product_id BIGINT NOT NULL COMMENT 'äº§å“ID',
    production_quantity DECIMAL(20,4) NOT NULL COMMENT 'ç”Ÿäº§æ•°é‡',
    standard_total_cost DECIMAL(20,2) NOT NULL COMMENT 'æ ‡å‡†æ€»æˆæœ¬',
    actual_total_cost DECIMAL(20,2) NOT NULL COMMENT 'å®é™…æ€»æˆæœ¬',
    total_variance DECIMAL(20,2) NOT NULL COMMENT 'æ€»å·®å¼‚',
    total_variance_rate DECIMAL(8,4) NOT NULL COMMENT 'æ€»å·®å¼‚ç‡',
    material_variance DECIMAL(20,2) DEFAULT 0 COMMENT 'ææ–™æˆæœ¬å·®å¼‚',
    material_variance_rate DECIMAL(8,4) DEFAULT 0 COMMENT 'ææ–™å·®å¼‚ç‡',
    labor_variance DECIMAL(20,2) DEFAULT 0 COMMENT 'äººå·¥æˆæœ¬å·®å¼‚',
    labor_variance_rate DECIMAL(8,4) DEFAULT 0 COMMENT 'äººå·¥å·®å¼‚ç‡',
    overhead_variance DECIMAL(20,2) DEFAULT 0 COMMENT 'åˆ¶é€ è´¹ç”¨å·®å¼‚',
    overhead_variance_rate DECIMAL(8,4) DEFAULT 0 COMMENT 'åˆ¶é€ è´¹ç”¨å·®å¼‚ç‡',
    variance_type INT DEFAULT 1 COMMENT 'å·®å¼‚ç±»å‹ï¼š1-æœ‰åˆ©ï¼Œ2-ä¸åˆ©',
    analysis_date DATETIME NOT NULL COMMENT 'åˆ†ææ—¥æœŸ',
    variance_reason VARCHAR(500) COMMENT 'å·®å¼‚åŸå› ',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_tenant_actual (tenant_id, cost_actual_id),
    INDEX idx_product (product_id),
    INDEX idx_analysis_date (analysis_date),
    INDEX idx_variance_type (variance_type)
) COMMENT='æˆæœ¬å·®å¼‚åˆ†æè¡¨';

-- å·¥æ—¶ç»Ÿè®¡è¡¨
CREATE TABLE erp_work_hours (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    work_order_id BIGINT NOT NULL COMMENT 'å·¥å•ID',
    process_id BIGINT NOT NULL COMMENT 'å·¥åºID',
    operator_id BIGINT COMMENT 'æ“ä½œå‘˜ID',
    work_date DATE NOT NULL COMMENT 'å·¥ä½œæ—¥æœŸ',
    shift_id BIGINT COMMENT 'ç­æ¬¡ID',
    start_time TIME COMMENT 'å¼€å§‹æ—¶é—´',
    end_time TIME COMMENT 'ç»“æŸæ—¶é—´',
    duration INT NOT NULL COMMENT 'å·¥ä½œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰',
    standard_duration INT DEFAULT 0 COMMENT 'æ ‡å‡†å·¥æ—¶ï¼ˆåˆ†é’Ÿï¼‰',
    overtime_duration INT DEFAULT 0 COMMENT 'åŠ ç­æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰',
    machine_hours DECIMAL(10,2) DEFAULT 0 COMMENT 'æœºæ—¶',
    operator_rate DECIMAL(10,2) COMMENT 'æ“ä½œå‘˜å·¥æ—¶è´¹ç‡',
    machine_rate DECIMAL(10,2) COMMENT 'è®¾å¤‡æ—¶è´¹ç‡',
    labor_cost DECIMAL(20,2) DEFAULT 0 COMMENT 'äººå·¥æˆæœ¬',
    machine_cost DECIMAL(20,2) DEFAULT 0 COMMENT 'è®¾å¤‡æˆæœ¬',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-æœ‰æ•ˆï¼Œ2-æ— æ•ˆ',
    remark VARCHAR(500) COMMENT 'å¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    INDEX idx_tenant_work_order (tenant_id, work_order_id),
    INDEX idx_process (process_id),
    INDEX idx_operator (operator_id),
    INDEX idx_work_date (work_date),
    INDEX idx_status (status)
) COMMENT='å·¥æ—¶ç»Ÿè®¡è¡¨';
```

#### 2. ç”Ÿäº§æ•°æ®åˆ†æç›¸å…³è¡¨
```sql
-- ç”Ÿäº§KPIè¡¨
CREATE TABLE erp_production_kpi (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    kpi_no VARCHAR(50) NOT NULL COMMENT 'KPIç¼–å·',
    kpi_name VARCHAR(255) NOT NULL COMMENT 'KPIåç§°',
    kpi_type INT NOT NULL COMMENT 'KPIç±»å‹ï¼š1-OEEï¼Œ2-åˆæ ¼ç‡ï¼Œ3-è¾¾æˆç‡ï¼Œ4-äº¤æœŸç‡',
    category INT DEFAULT 1 COMMENT 'åˆ†ç±»ï¼š1-æ•ˆç‡ï¼Œ2-è´¨é‡ï¼Œ3-äº¤ä»˜ï¼Œ4-æˆæœ¬',
    work_center_id BIGINT COMMENT 'å·¥ä½œä¸­å¿ƒID',
    product_id BIGINT COMMENT 'äº§å“ID',
    measurement_period INT NOT NULL COMMENT 'ç»Ÿè®¡å‘¨æœŸï¼š1-å°æ—¶ï¼Œ2-å¤©ï¼Œ3-å‘¨ï¼Œ4-æœˆ',
    target_value DECIMAL(20,4) COMMENT 'ç›®æ ‡å€¼',
    actual_value DECIMAL(20,4) NOT NULL COMMENT 'å®é™…å€¼',
    variance DECIMAL(20,4) COMMENT 'å·®å¼‚å€¼',
    variance_rate DECIMAL(8,4) COMMENT 'å·®å¼‚ç‡',
    calculation_date DATETIME NOT NULL COMMENT 'è®¡ç®—æ—¥æœŸ',
    period_start_time DATETIME NOT NULL COMMENT 'å‘¨æœŸå¼€å§‹æ—¶é—´',
    period_end_time DATETIME NOT NULL COMMENT 'å‘¨æœŸç»“æŸæ—¶é—´',
    data_source VARCHAR(100) COMMENT 'æ•°æ®æ¥æº',
    remarks TEXT COMMENT 'å¤‡æ³¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_tenant_kpi (tenant_id, kpi_no),
    INDEX idx_type (kpi_type),
    INDEX idx_work_center (work_center_id),
    INDEX idx_product (product_id),
    INDEX idx_calculation_date (calculation_date)
) COMMENT='ç”Ÿäº§KPIè¡¨';

-- ç”Ÿäº§æŠ¥è¡¨è¡¨
CREATE TABLE erp_production_report (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    report_no VARCHAR(50) NOT NULL COMMENT 'æŠ¥è¡¨ç¼–å·',
    report_name VARCHAR(255) NOT NULL COMMENT 'æŠ¥è¡¨åç§°',
    report_type INT NOT NULL COMMENT 'æŠ¥è¡¨ç±»å‹ï¼š1-æ—¥æŠ¥ï¼Œ2-å‘¨æŠ¥ï¼Œ3-æœˆæŠ¥ï¼Œ4-å¹´æŠ¥',
    report_period VARCHAR(50) NOT NULL COMMENT 'æŠ¥è¡¨æœŸé—´',
    work_center_id BIGINT COMMENT 'å·¥ä½œä¸­å¿ƒID',
    production_orders INT DEFAULT 0 COMMENT 'ç”Ÿäº§è®¢å•æ•°',
    total_plan_quantity DECIMAL(20,4) DEFAULT 0 COMMENT 'æ€»è®¡åˆ’æ•°é‡',
    total_completed_quantity DECIMAL(20,4) DEFAULT 0 COMMENT 'æ€»å®Œæˆæ•°é‡',
    total_qualified_quantity DECIMAL(20,4) DEFAULT 0 COMMENT 'æ€»åˆæ ¼æ•°é‡',
    completion_rate DECIMAL(5,2) DEFAULT 0 COMMENT 'å®Œæˆç‡',
    quality_rate DECIMAL(5,2) DEFAULT 0 COMMENT 'åˆæ ¼ç‡',
    total_work_hours DECIMAL(20,2) DEFAULT 0 COMMENT 'æ€»å·¥æ—¶',
    total_equipment_hours DECIMAL(20,2) DEFAULT 0 COMMENT 'æ€»æœºæ—¶',
    oee DECIMAL(5,2) DEFAULT 0 COMMENT 'OEE',
    on_time_delivery_rate DECIMAL(5,2) DEFAULT 0 COMMENT 'å‡†æ—¶äº¤ä»˜ç‡',
    production_value DECIMAL(20,2) DEFAULT 0 COMMENT 'äº§å€¼',
    average_cost DECIMAL(20,4) DEFAULT 0 COMMENT 'å¹³å‡æˆæœ¬',
    report_date DATE NOT NULL COMMENT 'æŠ¥è¡¨æ—¥æœŸ',
    generate_time DATETIME NOT NULL COMMENT 'ç”Ÿæˆæ—¶é—´',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-è‰ç¨¿ï¼Œ2-å·²å‘å¸ƒ',
    report_data TEXT COMMENT 'è¯¦ç»†æ•°æ®ï¼ˆJSONï¼‰',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_tenant_report (tenant_id, report_no),
    INDEX idx_type (report_type),
    INDEX idx_work_center (work_center_id),
    INDEX idx_report_date (report_date)
) COMMENT='ç”Ÿäº§æŠ¥è¡¨è¡¨';

-- çœ‹æ¿é…ç½®è¡¨
CREATE TABLE erp_production_dashboard_config (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    tenant_id BIGINT NOT NULL COMMENT 'ç§Ÿæˆ·ID',
    config_name VARCHAR(255) NOT NULL COMMENT 'é…ç½®åç§°',
    config_type INT DEFAULT 1 COMMENT 'é…ç½®ç±»å‹ï¼š1-å¤§å±ï¼Œ2-PCç«¯ï¼Œ3-ç§»åŠ¨ç«¯',
    screen_resolution VARCHAR(50) COMMENT 'å±å¹•åˆ†è¾¨ç‡',
    layout_config TEXT NOT NULL COMMENT 'å¸ƒå±€é…ç½®ï¼ˆJSONï¼‰',
    component_config TEXT NOT NULL COMMENT 'ç»„ä»¶é…ç½®ï¼ˆJSONï¼‰',
    data_refresh_interval INT DEFAULT 5 COMMENT 'æ•°æ®åˆ·æ–°é—´éš”ï¼ˆç§’ï¼‰',
    is_default TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦é»˜è®¤é…ç½®',
    is_active TINYINT DEFAULT 1 COMMENT 'æ˜¯å¦å¯ç”¨',
    creator VARCHAR(64) COMMENT 'åˆ›å»ºäºº',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) COMMENT 'æ›´æ–°äºº',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤',

    INDEX idx_tenant_config (tenant_id, config_name),
    INDEX idx_type (config_type),
    INDEX idx_active (is_active)
) COMMENT='çœ‹æ¿é…ç½®è¡¨';
```

### ğŸ”§ æ ¸å¿ƒæœåŠ¡å®ç°

#### æˆæœ¬æ ¸ç®—æœåŠ¡
```java
@Service
@RequiredArgsConstructor
public class CostAccountingServiceImpl implements CostAccountingService {

    private final CostActualMapper actualMapper;
    private final CostStandardMapper standardMapper;
    private readonly CostVarianceMapper varianceMapper;
    private final WorkHoursMapper workHoursMapper;
    private final WorkOrderService workOrderService;

    /**
     * è®¡ç®—å®é™…æˆæœ¬
     */
    @Override
    @Transactional(rollbackFor = Exception.class)
    public void calculateActualCost(CostCalculationReqVO calculationReqVO) {
        // 1. ç”Ÿæˆæˆæœ¬å•å·
        String costNo = generateCostNo();

        try {
            // 2. è·å–å·¥å•ä¿¡æ¯
            WorkOrderDO workOrder = workOrderService.getWorkOrder(calculationReqVO.getWorkOrderId());

            // 3. è®¡ç®—ææ–™æˆæœ¬
            BigDecimal materialCost = calculateMaterialCost(calculationReqVO);

            // 4. è®¡ç®—äººå·¥æˆæœ¬
            BigDecimal laborCost = calculateLaborCost(calculationReqVO);

            // 5. è®¡ç®—åˆ¶é€ è´¹ç”¨
            BigDecimal overheadCost = calculateOverheadCost(calculationReqVO);

            // 6. åˆ›å»ºå®é™…æˆæœ¬è®°å½•
            CostActualDO actualCost = new CostActualDO();
            actualCost.setCostNo(costNo);
            actualCost.setWorkOrderId(calculationReqVO.getWorkOrderId());
            actualCost.setProductionOrderId(workOrder.getProductionOrderId());
            actualCost.setProductId(workOrder.getProductId());
            actualCost.setProductionQuantity(workOrder.getCompletedQuantity());

            actualCost.setMaterialCost(materialCost);
            actualCost.setLaborCost(laborCost);
            actualCost.setOverheadCost(overheadCost);
            actualCost.setTotalCost(materialCost.add(laborCost).add(overheadCost));
            actualCost.setUnitCost(calculateUnitCost(workOrder.getCompletedQuantity(), materialCost.add(laborCost).add(overheadCost)));

            actualCost.setCostPeriod(LocalDateTime.now().format(DateTimeFormatter.ofPattern("yyyy-MM")));
            actualCost.setCalculationDate(LocalDateTime.now());
            actualCost.setStatus(CostActualStatusEnum.CALCULATED.getCode());

            actualMapper.insert(actualCost);

            // 7. è¿›è¡Œæˆæœ¬å·®å¼‚åˆ†æ
            performVarianceAnalysis(actualCost);

            // 8. æ›´æ–°å·¥å•çŠ¶æ€
            updateWorkOrderCostStatus(workOrder.getId(), actualCost.getId());

            log.info("æˆæœ¬è®¡ç®—å®Œæˆï¼Œæˆæœ¬å•å·ï¼š{}", costNo);

        } catch (Exception e) {
            log.error("æˆæœ¬è®¡ç®—å¤±è´¥ï¼Œæˆæœ¬å•å·ï¼š{}", costNo, e);
            throw new CostCalculationException("æˆæœ¬è®¡ç®—å¤±è´¥ï¼š" + e.getMessage());
        }
    }

    /**
     * è®¡ç®—ææ–™æˆæœ¬
     */
    private BigDecimal calculateMaterialCost(CostCalculationReqVO calculationReqVO) {
        BigDecimal totalMaterialCost = BigDecimal.ZERO;

        // 1. è·å–å·¥å•ç‰©æ–™æ¶ˆè€—è®°å½•
        List<MaterialConsumptionDO> consumptions = materialConsumptionMapper
                .selectByWorkOrderId(calculationReqVO.getWorkOrderId());

        for (MaterialConsumptionDO consumption : consumptions) {
            // 2. è·å–ææ–™å•ä»·
            BigDecimal unitPrice = getMaterialUnitPrice(consumption.getProductId());

            // 3. è®¡ç®—ææ–™æˆæœ¬
            BigDecimal materialCost = consumption.getConsumedQuantity().multiply(unitPrice);

            totalMaterialCost = totalMaterialCost.add(materialCost);
        }

        // 4. åº”ç”¨ææ–™æˆæœ¬è°ƒæ•´
        if (calculationReqVO.getMaterialAdjustAmount() != null) {
            totalMaterialCost = totalMaterialCost.add(calculationReqVO.getMaterialAdjustAmount());
        }

        return totalMaterialCost;
    }

    /**
     * è®¡ç®—äººå·¥æˆæœ¬
     */
    private BigDecimal calculateLaborCost(CostCalculationReqVO calculationReqVO) {
        // 1. è·å–å·¥å•å·¥æ—¶ç»Ÿè®¡
        List<WorkHoursDO> workHoursList = workHoursMapper
                .selectByWorkOrderId(calculationReqVO.getWorkOrderId());

        BigDecimal totalLaborCost = BigDecimal.ZERO;

        for (WorkHoursDO workHours : workHoursList) {
            // 2. è®¡ç®—äººå·¥æˆæœ¬ = å·¥æ—¶ * è´¹ç‡
            BigDecimal laborHours = BigDecimal.valueOf(workHours.getDuration())
                    .divide(BigDecimal.valueOf(60), 4, RoundingMode.HALF_UP); // è½¬æ¢ä¸ºå°æ—¶

            BigDecimal laborCost = laborHours.multiply(workHours.getOperatorRate());
            totalLaborCost = totalLaborCost.add(laborCost);
        }

        // 3. åº”ç”¨äººå·¥æˆæœ¬è°ƒæ•´
        if (calculationReqVO.getLaborAdjustAmount() != null) {
            totalLaborCost = totalLaborCost.add(calculationReqVO.getLaborAdjustAmount());
        }

        return totalLaborCost;
    }

    /**
     * è®¡ç®—åˆ¶é€ è´¹ç”¨
     */
    private BigDecimal calculateOverheadCost(CostCalculationReqVO calculationReqVO) {
        // 1. è·å–å·¥æ—¶ç»Ÿè®¡
        List<WorkHoursDO> workHoursList = workHoursMapper
                .selectByWorkOrderId(calculationReqVO.getWorkOrderId());

        BigDecimal totalMachineCost = BigDecimal.ZERO;
        BigDecimal totalUtilityCost = BigDecimal.ZERO;
        BigDecimal totalOtherCost = BigDecimal.ZERO;

        for (WorkHoursDO workHours : workHoursList) {
            // 2. è®¾å¤‡æˆæœ¬
            BigDecimal machineHours = BigDecimal.valueOf(workHours.getMachineHours());
            totalMachineCost = totalMachineCost.add(machineHours.multiply(workHours.getMachineRate()));

            // 3. æ°´ç”µè´¹ç­‰åˆ¶é€ è´¹ç”¨ï¼ˆæ ¹æ®è®¾å¤‡ç±»å‹å’Œå·¥æ—¶è®¡ç®—ï¼‰
            BigDecimal utilityCost = calculateUtilityCost(workHours);
            totalUtilityCost = totalUtilityCost.add(utilityCost);

            // 4. å…¶ä»–åˆ¶é€ è´¹ç”¨
            BigDecimal otherCost = calculateOtherOverhead(workHours);
            totalOtherCost = totalOtherCost.add(otherCost);
        }

        BigDecimal totalOverheadCost = totalMachineCost.add(totalUtilityCost).add(totalOtherCost);

        // 5. åº”ç”¨åˆ¶é€ è´¹ç”¨è°ƒæ•´
        if (calculationReqVO.getOverheadAdjustAmount() != null) {
            totalOverheadCost = totalOverheadCost.add(calculationReqVO.getOverheadAdjustAmount());
        }

        return totalOverheadCost;
    }

    /**
     * æˆæœ¬å·®å¼‚åˆ†æ
     */
    @Transactional(rollbackFor = Exception.class)
    public void performVarianceAnalysis(CostActualDO actualCost) {
        try {
            // 1. è·å–æ ‡å‡†æˆæœ¬
            CostStandardDO standardCost = standardMapper.selectByProductId(actualCost.getProductId());

            if (standardCost == null) {
                log.warn("æœªæ‰¾åˆ°äº§å“[{}]çš„æ ‡å‡†æˆæœ¬ï¼Œæ— æ³•è¿›è¡Œå·®å¼‚åˆ†æ", actualCost.getProductId());
                return;
            }

            // 2. è®¡ç®—å„é¡¹å·®å¼‚
            BigDecimal standardTotalCost = standardCost.getTotalCost()
                    .multiply(actualCost.getProductionQuantity());

            BigDecimal materialVariance = actualCost.getMaterialCost()
                    .subtract(standardCost.getMaterialCost().multiply(actualCost.getProductionQuantity()));

            BigDecimal laborVariance = actualCost.getLaborCost()
                    .subtract(standardCost.getLaborCost().multiply(actualCost.getProductionQuantity()));

            BigDecimal overheadVariance = actualCost.getOverheadCost()
                    .subtract(standardCost.getOverheadCost().multiply(actualCost.getProductionQuantity()));

            BigDecimal totalVariance = actualCost.getTotalCost().subtract(standardTotalCost);

            // 3. åˆ›å»ºå·®å¼‚åˆ†æè®°å½•
            CostVarianceDO variance = new CostVarianceDO();
            variance.setCostActualId(actualCost.getId());
            variance.setProductId(actualCost.getProductId());
            variance.setProductionQuantity(actualCost.getProductionQuantity());
            variance.setStandardTotalCost(standardTotalCost);
            variance.setActualTotalCost(actualCost.getTotalCost());
            variance.setTotalVariance(totalVariance);

            variance.setMaterialVariance(materialVariance);
            variance.setLaborVariance(laborVariance);
            variance.setOverheadVariance(overheadVariance);

            // 4. è®¡ç®—å·®å¼‚ç‡
            if (standardTotalCost.compareTo(BigDecimal.ZERO) > 0) {
                variance.setTotalVarianceRate(
                        totalVariance.divide(standardTotalCost, 4, RoundingMode.HALF_UP)
                                .multiply(BigDecimal.valueOf(100)));
                variance.setMaterialVarianceRate(
                        materialVariance.divide(standardCost.getMaterialCost(), 4, RoundingMode.HALF_UP)
                                .multiply(BigDecimal.valueOf(100)));
                variance.setLaborVarianceRate(
                        laborVariance.divide(standardCost.getLaborCost(), 4, RoundingMode.HALF_UP)
                                .multiply(BigDecimal.valueOf(100)));
                variance.setOverheadVarianceRate(
                        overheadVariance.divide(standardCost.getOverheadCost(), 4, RoundingMode.HALF_UP)
                                .multiply(BigDecimal.valueOf(100)));
            }

            // 5. åˆ¤æ–­å·®å¼‚ç±»å‹
            variance.setVarianceType(totalVariance.compareTo(BigDecimal.ZERO) <= 0 ?
                                   CostVarianceTypeEnum.FAVORABLE.getCode() :
                                   CostVarianceTypeEnum.UNFAVORABLE.getCode());

            variance.setAnalysisDate(LocalDateTime.now());

            // 6. åˆ†æå·®å¼‚åŸå› 
            variance.setVarianceReason(analyzeVarianceReasons(materialVariance, laborVariance, overheadVariance));

            varianceMapper.insert(variance);

            // 7. å‘é€å·®å¼‚é¢„è­¦ï¼ˆå¦‚æœå·®å¼‚è¿‡å¤§ï¼‰
            if (Math.abs(variance.getTotalVarianceRate().doubleValue()) > 10) { // å·®å¼‚è¶…è¿‡10%
                sendVarianceAlert(actualCost, variance);
            }

        } catch (Exception e) {
            log.error("æˆæœ¬å·®å¼‚åˆ†æå¤±è´¥ï¼Œå®é™…æˆæœ¬IDï¼š{}", actualCost.getId(), e);
        }
    }

    /**
     * ç”Ÿæˆç”Ÿäº§æŠ¥è¡¨
     */
    @Override
    @Async("reportExecutor")
    public void generateProductionReport(ProductionReportReqVO reportReqVO) {
        try {
            log.info("å¼€å§‹ç”Ÿæˆç”Ÿäº§æŠ¥è¡¨ï¼š{}", reportReqVO);

            // 1. ç”ŸæˆæŠ¥è¡¨ç¼–å·
            String reportNo = generateReportNo();

            // 2. è·å–æ•°æ®
            List<WorkOrderDO> workOrders = workOrderService
                    .getWorkOrdersByPeriod(reportReqVO);

            // 3. è®¡ç®—ç»Ÿè®¡æŒ‡æ ‡
            ProductionReportVO report = calculateReportMetrics(workOrders);

            // 4. åˆ›å»ºæŠ¥è¡¨è®°å½•
            ProductionReportDO reportDO = new ProductionReportDO();
            reportDO.setReportNo(reportNo);
            reportDO.setReportName(generateReportName(reportReqVO));
            reportDO.setReportType(reportReqVO.getReportType());
            reportDO.setReportPeriod(reportReqVO.getPeriod());
            reportDO.setWorkCenterId(reportReqVO.getWorkCenterId());

            reportDO.setProductionOrders(report.getTotalOrders());
            reportDO.setTotalPlanQuantity(report.getTotalPlanQuantity());
            reportDO.setTotalCompletedQuantity(report.getTotalCompletedQuantity());
            reportDO.setTotalQualifiedQuantity(report.getTotalQualifiedQuantity());
            reportDO.setCompletionRate(report.getCompletionRate());
            reportDO.setQualityRate(report.getQualityRate());
            reportDO.setTotalWorkHours(report.getTotalWorkHours());
            reportDO.setOEE(report.getOEE());
            reportDO.setProductionValue(report.getProductionValue());
            reportDO.setAverageCost(report.getAverageCost());

            reportDO.setReportDate(LocalDate.now());
            reportDO.setGenerateTime(LocalDateTime.now());
            reportDO.setStatus(ProductionReportStatusEnum.DRAFT.getCode());
            reportDO.setReportData(JSON.toJSONString(report.getDetailData()));

            productionReportMapper.insert(reportDO);

            log.info("ç”Ÿäº§æŠ¥è¡¨ç”Ÿæˆå®Œæˆï¼ŒæŠ¥è¡¨ç¼–å·ï¼š{}", reportNo);

        } catch (Exception e) {
            log.error("ç”Ÿäº§æŠ¥è¡¨ç”Ÿæˆå¤±è´¥", e);
            throw new ReportGenerationException("ç”Ÿäº§æŠ¥è¡¨ç”Ÿæˆå¤±è´¥ï¼š" + e.getMessage());
        }
    }
}
```

### ğŸ“Š Phase 4 äº¤ä»˜æ¸…å•

#### å¼€å‘æ­¥éª¤æ£€æŸ¥æ¸…å•
- [ ] **æ­¥éª¤1ï¼šæ•°æ®åº“è¡¨ç»“æ„**
  - [ ] è®¾è®¡å¹¶åˆ›å»ºæˆæœ¬æ ¸ç®—ç›¸å…³è¡¨ï¼ˆ4å¼ ï¼‰
  - [ ] è®¾è®¡å¹¶åˆ›å»ºç”Ÿäº§æ•°æ®åˆ†æç›¸å…³è¡¨ï¼ˆ3å¼ ï¼‰
  - [ ] æ‰§è¡ŒSQLè„šæœ¬éªŒè¯æ‰€æœ‰è¡¨ç»“æ„

- [ ] **æ­¥éª¤2ï¼šä»£ç ç”Ÿæˆ**
  - [ ] ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆæˆæœ¬æ ¸ç®—ä»£ç 
  - [ ] ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆç”Ÿäº§æ•°æ®åˆ†æä»£ç 
  - [ ] éªŒè¯åŸºç¡€CRUDåŠŸèƒ½æ­£å¸¸

- [ ] **æ­¥éª¤3ï¼šè°ƒè¯•ä¼˜åŒ–**
  - [ ] å®ç°æˆæœ¬æ ¸ç®—ç®—æ³•
  - [ ] å®ç°æˆæœ¬å·®å¼‚åˆ†æé€»è¾‘
  - [ ] å®ç°ç”Ÿäº§KPIè®¡ç®—å’ŒæŠ¥è¡¨ç”Ÿæˆ
  - [ ] å¼€å‘æ•°æ®çœ‹æ¿å’Œå¯è§†åŒ–å›¾è¡¨

#### åç«¯äº¤ä»˜ç‰©
- [ ] æˆæœ¬æ ¸ç®—æœåŠ¡ï¼ˆ20ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼‰
- [ ] ç”Ÿäº§æ•°æ®åˆ†ææœåŠ¡ï¼ˆ15ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼‰
- [ ] æŠ¥è¡¨ç”ŸæˆæœåŠ¡ï¼ˆå®šæ—¶ä»»åŠ¡ã€å¼‚æ­¥ç”Ÿæˆï¼‰
- [ ] æ•°æ®å¯è§†åŒ–æœåŠ¡ï¼ˆå›¾è¡¨æ•°æ®å¤„ç†ï¼‰
- [ ] RESTful APIæ¥å£ï¼ˆ35ä¸ªæ¥å£ï¼‰
- [ ] æ•°æ®å¯¼å‡ºæœåŠ¡ï¼ˆExcelã€PDFï¼‰

#### å‰ç«¯äº¤ä»˜ç‰©
- [ ] æˆæœ¬æ ¸ç®—ç•Œé¢ï¼ˆæˆæœ¬æ ¸ç®—ã€å·®å¼‚åˆ†æï¼‰
- [ ] ç”Ÿäº§æŠ¥è¡¨ç•Œé¢ï¼ˆæ—¥æŠ¥ã€å‘¨æŠ¥ã€æœˆæŠ¥ï¼‰
- [ ] æ•°æ®çœ‹æ¿ç•Œé¢ï¼ˆå¤§å±å±•ç¤ºã€å®æ—¶æ•°æ®ï¼‰
- [ ] ç§»åŠ¨ç«¯æ•°æ®æŸ¥è¯¢ï¼ˆæˆæœ¬æŸ¥è¯¢ã€æŒ‡æ ‡æŸ¥çœ‹ï¼‰
- [ ] æ•°æ®åˆ†æå›¾è¡¨ï¼ˆè¶‹åŠ¿åˆ†æã€å¯¹æ¯”åˆ†æï¼‰

#### æŠ€æœ¯äº®ç‚¹
- [ ] å¤æ‚æˆæœ¬æ ¸ç®—ç®—æ³•
- [ ] å¤§æ•°æ®é‡æŠ¥è¡¨æ€§èƒ½ä¼˜åŒ–ï¼ˆåˆ†é¡µæŸ¥è¯¢ã€ç¼“å­˜ï¼‰
- [ ] æ•°æ®å¯è§†åŒ–ï¼ˆEChartsã€å›¾è¡¨åº“ï¼‰
- [ ] å¼‚æ­¥æŠ¥è¡¨ç”Ÿæˆï¼ˆSpring Async + æ¶ˆæ¯é˜Ÿåˆ—ï¼‰

---

## ğŸ¯ æ•´ä½“æŠ€æœ¯æ¶æ„æ€»ç»“

### ç³»ç»Ÿæ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ERP ç”Ÿäº§ç®¡ç†ç³»ç»Ÿ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‰ç«¯å±‚ (Vue3 + TypeScript + Element Plus + ECharts)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ç”Ÿäº§è®¢å•  â”‚ç”Ÿäº§è®¡åˆ’  â”‚ç”Ÿäº§æ‰§è¡Œ  â”‚è´¨é‡ç®¡ç†  â”‚æˆæœ¬åˆ†æ  â”‚        â”‚
â”‚  â”‚ç®¡ç†ç•Œé¢  â”‚ç®¡ç†ç•Œé¢  â”‚ç®¡ç†ç•Œé¢  â”‚ç®¡ç†ç•Œé¢  â”‚ç®¡ç†ç•Œé¢  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½ï¿½â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœåŠ¡å±‚ (Spring Boot + MyBatis-Plus)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ç”Ÿäº§è®¢å•æœåŠ¡ (ProductionOrderService)                      â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  ç”Ÿäº§è®¡åˆ’æœåŠ¡ (ProductionPlanningService)                   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  ç”Ÿäº§æ‰§è¡ŒæœåŠ¡ (ProductionExecutionService)                  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  è´¨é‡ç®¡ç†æœåŠ¡ (QualityManagementService)                    â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  æˆæœ¬æ ¸ç®—æœåŠ¡ (CostAccountingService)                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¶ˆæ¯é˜Ÿåˆ— (RabbitMQ) - å¼‚æ­¥å¤„ç†                                     â”‚
â”‚  â”œâ”€ MRPè®¡ç®—é˜Ÿåˆ—ã€æŠ¥è¡¨ç”Ÿæˆé˜Ÿåˆ—ã€æˆæœ¬è®¡ç®—é˜Ÿåˆ—ã€è®¾å¤‡ç›‘æ§é˜Ÿåˆ—             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç¼“å­˜å±‚ (Redis)                                                   â”‚
â”‚  â”œâ”€ BOMæ•°æ®ç¼“å­˜ã€ç”Ÿäº§æ•°æ®ç¼“å­˜ã€KPIæŒ‡æ ‡ç¼“å­˜                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®è®¿é—®å±‚ (MyBatis-Plus + Druid)                                 â”‚
â”‚  â”œâ”€ åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–ã€ç´¢å¼•ä¼˜åŒ–ã€è¯»å†™åˆ†ç¦»                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®åº“å±‚ (MySQL 8.0 ä¸»ä»å¤åˆ¶ + ShardingSphere åˆ†åº“åˆ†è¡¨)           â”‚
â”‚  â”œâ”€ ç°æœ‰æ¨¡å—ï¼š28å¼ è¡¨                                                â”‚
â”‚  â”œâ”€ ç”Ÿäº§æ¨¡å—ï¼š3å¼ è¡¨ï¼ˆPhase1ï¼‰                                       â”‚
â”‚  â”œâ”€ è®¡åˆ’æ¨¡å—ï¼š12å¼ è¡¨ï¼ˆPhase2ï¼‰                                      â”‚
â”‚  â”œâ”€ æ‰§è¡Œæ¨¡å—ï¼š15å¼ è¡¨ï¼ˆPhase3ï¼‰                                      â”‚
â”‚  â””â”€ æˆæœ¬æ¨¡å—ï¼š8å¼ è¡¨ï¼ˆPhase4ï¼‰                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¼€å‘è®¡åˆ’æ€»è§ˆ

| é˜¶æ®µ | æ—¶é—´å‘¨æœŸ | ä¸»è¦åŠŸèƒ½ | æ•°æ®åº“è¡¨æ•° | APIæ¥å£æ•° | å‰ç«¯é¡µé¢æ•° | å›¢é˜Ÿäººå‘˜ |
|------|----------|----------|------------|-----------|------------|----------|
| Phase 1 | 4å‘¨ | ç”Ÿäº§è®¢å•ç®¡ç† | 3å¼ æ–°è¡¨ | 25ä¸ª | 5ä¸ª | 6äºº |
| Phase 2 | 5å‘¨ | ç”Ÿäº§è®¡åˆ’ç®¡ç† | 12å¼ æ–°è¡¨ | 40ä¸ª | 8ä¸ª | 8äºº |
| Phase 3 | 6å‘¨ | ç”Ÿäº§æ‰§è¡Œä¸è´¨é‡ç®¡ç† | 15å¼ æ–°è¡¨ | 60ä¸ª | 10ä¸ª | 10äºº |
| Phase 4 | 5å‘¨ | æˆæœ¬æ ¸ç®—ä¸æ•°æ®åˆ†æ | 8å¼ æ–°è¡¨ | 35ä¸ª | 7ä¸ª | 8äºº |
| **æ€»è®¡** | **20å‘¨** | **å®Œæ•´ç”Ÿäº§ç®¡ç†ç³»ç»Ÿ** | **38å¼ æ–°è¡¨** | **160ä¸ª** | **30ä¸ª** | **10äºº** |

### å…³é”®æŠ€æœ¯é€‰å‹

| æŠ€æœ¯ç±»åˆ« | é€‰å‹æ–¹æ¡ˆ | ç‰ˆæœ¬ | è¯´æ˜ |
|----------|----------|------|------|
| åç«¯æ¡†æ¶ | Spring Boot | 3.x | å¾®æœåŠ¡æ¶æ„ |
| ORMæ¡†æ¶ | MyBatis-Plus | 3.5.x | å¢å¼ºç‰ˆMyBatis |
| å®‰å…¨æ¡†æ¶ | Spring Security | 6.x | æƒé™æ§åˆ¶ |
| å·¥ä½œæµ | Activiti | 7.x | æµç¨‹å®¡æ‰¹ |
| æ¶ˆæ¯é˜Ÿåˆ— | RabbitMQ | 3.12.x | å¼‚æ­¥å¤„ç† |
| ç¼“å­˜ | Redis | 7.x | æ•°æ®ç¼“å­˜ |
| æ•°æ®åº“ | MySQL | 8.0 | ä¸»ä»å¤åˆ¶ |
| åˆ†åº“åˆ†è¡¨ | ShardingSphere | 5.x | æ•°æ®åˆ†ç‰‡ |
| å‰ç«¯æ¡†æ¶ | Vue.js | 3.x | å“åº”å¼å‰ç«¯ |
| UIç»„ä»¶åº“ | Element Plus | 2.x | UIç»„ä»¶ |
| å›¾è¡¨åº“ | ECharts | 5.x | æ•°æ®å¯è§†åŒ– |
| æ„å»ºå·¥å…· | Vite | 4.x | å¿«é€Ÿæ„å»º |

---

## ğŸ“ æ–‡æ¡£ä¿¡æ¯

**æ–‡æ¡£åç§°**: ç”Ÿäº§ç®¡ç†ç³»ç»Ÿå¼€å‘è®¡åˆ’ - ç»†åŒ–ç‰ˆ
**ç‰ˆæœ¬**: v4.0
**åˆ›å»ºæ—¥æœŸ**: 2025-11-15
**æœ€åæ›´æ–°**: 2025-11-15
**è´Ÿè´£äºº**: å¼€å‘å›¢é˜Ÿ
**å®¡æ ¸çŠ¶æ€**: å¾…å®¡æ ¸

**æ–‡æ¡£è¯´æ˜**:
æœ¬æ–‡æ¡£ä¸ºç”Ÿäº§ç®¡ç†ç³»ç»Ÿå¼€å‘è®¡åˆ’çš„ç»†åŒ–ç‰ˆï¼ŒåŒ…å«ï¼š
- 4ä¸ªå®Œæ•´å¼€å‘é˜¶æ®µè¯¦ç»†æ–¹æ¡ˆ
- æ•°æ®åº“è¡¨ç»“æ„è®¾è®¡ï¼ˆ38å¼ æ–°è¡¨ï¼‰
- æ ¸å¿ƒæœåŠ¡å®ç°ä»£ç ç¤ºä¾‹
- å‰ç«¯ç»„ä»¶æ¶æ„è®¾è®¡
- æŠ€æœ¯æ¶æ„é€‰å‹è¯´æ˜
- å®Œæ•´çš„äº¤ä»˜æ¸…å•å’Œé‡Œç¨‹ç¢‘

**æ›´æ–°å†å²**:
- v4.0 (2025-11-15): å®Œæˆ4ä¸ªé˜¶æ®µç»†åŒ–æ–¹æ¡ˆç¼–å†™
```
