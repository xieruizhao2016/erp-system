# å‰ç«¯èœå•ç»„ä»¶åç§°ä¿®å¤è®°å½•

## ğŸ“‹ é—®é¢˜æè¿°

å‰ç«¯èœå•æ²¡æœ‰æ˜¾ç¤ºæœ€æ–°çš„åŠŸèƒ½ï¼ˆè´¢åŠ¡ç®¡ç†æ¨¡å—ï¼‰ï¼Œè™½ç„¶åç«¯APIæ­£å¸¸è¿”å›äº†èœå•æ•°æ®ã€‚

## ğŸ” é—®é¢˜åŸå› 

é€šè¿‡æ£€æŸ¥å‘ç°ï¼Œ**ç»„ä»¶åç§°ä¸åŒ¹é…**å¯¼è‡´è·¯ç”±æ— æ³•æ­£ç¡®è§£æï¼š

### åç«¯è¿”å›çš„ç»„ä»¶åç§°
- ä»˜æ¬¾å•: `componentName: 'ErpFinancePayment'`
- æ”¶æ¬¾å•: `componentName: 'ErpFinanceReceipt'`
- ç»“ç®—è´¦æˆ·: `componentName: 'ErpAccount'`

### å‰ç«¯å®é™…çš„ç»„ä»¶åç§°ï¼ˆä¿®å¤å‰ï¼‰
- ä»˜æ¬¾å•: `name: 'ErpPurchaseOrder'` âŒ
- æ”¶æ¬¾å•: `name: 'ErpPurchaseOrder'` âŒ
- ç»“ç®—è´¦æˆ·: `name: 'ErpAccount'` âœ…

## âœ… ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤çš„æ–‡ä»¶

1. **ä»˜æ¬¾å•ç»„ä»¶**
   - æ–‡ä»¶: `original-yudao-ui/src/views/erp/finance/payment/index.vue`
   - ä¿®æ”¹: `defineOptions({ name: 'ErpPurchaseOrder' })` 
   - æ”¹ä¸º: `defineOptions({ name: 'ErpFinancePayment' })`

2. **æ”¶æ¬¾å•ç»„ä»¶**
   - æ–‡ä»¶: `original-yudao-ui/src/views/erp/finance/receipt/index.vue`
   - ä¿®æ”¹: `defineOptions({ name: 'ErpPurchaseOrder' })`
   - æ”¹ä¸º: `defineOptions({ name: 'ErpFinanceReceipt' })`

### ä¿®å¤åçš„åŒ¹é…æƒ…å†µ

| èœå•é¡¹ | åç«¯componentName | å‰ç«¯ç»„ä»¶name | çŠ¶æ€ |
|--------|------------------|-------------|------|
| ä»˜æ¬¾å• | ErpFinancePayment | ErpFinancePayment | âœ… åŒ¹é… |
| æ”¶æ¬¾å• | ErpFinanceReceipt | ErpFinanceReceipt | âœ… åŒ¹é… |
| ç»“ç®—è´¦æˆ· | ErpAccount | ErpAccount | âœ… åŒ¹é… |

## ğŸ”§ ä¿®å¤æ­¥éª¤

1. **ä¿®æ”¹ç»„ä»¶åç§°**
   ```bash
   # ä»˜æ¬¾å•
   sed -i "s/name: 'ErpPurchaseOrder'/name: 'ErpFinancePayment'/" \
     original-yudao-ui/src/views/erp/finance/payment/index.vue
   
   # æ”¶æ¬¾å•
   sed -i "s/name: 'ErpPurchaseOrder'/name: 'ErpFinanceReceipt'/" \
     original-yudao-ui/src/views/erp/finance/receipt/index.vue
   ```

2. **é‡æ–°æ„å»ºå‰ç«¯**
   ```bash
   cd original-yudao-ui
   pnpm build:prod
   ```

3. **éƒ¨ç½²åˆ°æœåŠ¡å™¨**
   ```bash
   scp -i tengxunyun.pem -r original-yudao-ui/dist-prod/* \
     ubuntu@101.33.244.240:/tmp/dist-prod/
   
   ssh -i tengxunyun.pem ubuntu@101.33.244.240 \
     "docker cp /tmp/dist-prod/. yudao-admin-prod:/usr/share/nginx/html/"
   ```

## ğŸ“ æŠ€æœ¯è¯´æ˜

### è·¯ç”±ç”Ÿæˆæœºåˆ¶

å‰ç«¯ä½¿ç”¨åŠ¨æ€è·¯ç”±ç”Ÿæˆæœºåˆ¶ï¼Œä»åç«¯è·å–èœå•æ•°æ®åï¼š

1. **è·å–èœå•æ•°æ®**
   - API: `/admin-api/system/auth/get-permission-info`
   - è¿”å›èœå•åˆ—è¡¨ï¼ŒåŒ…å« `componentName` å’Œ `component` å­—æ®µ

2. **ç”Ÿæˆè·¯ç”±**
   - ä½¿ç”¨ `routerHelper.ts` ä¸­çš„ `generateRoute()` å‡½æ•°
   - æ ¹æ® `componentName` åŒ¹é…å‰ç«¯ç»„ä»¶
   - æ ¹æ® `component` è·¯å¾„åŠ è½½ç»„ä»¶æ–‡ä»¶

3. **ç»„ä»¶åŒ¹é…**
   - ä½¿ç”¨ `componentName` ä½œä¸ºè·¯ç”±çš„ `name`
   - ä½¿ç”¨ `component` è·¯å¾„æŸ¥æ‰¾å¯¹åº”çš„ Vue ç»„ä»¶æ–‡ä»¶
   - å¦‚æœ `componentName` ä¸åŒ¹é…ï¼Œè·¯ç”±æ— æ³•æ­£ç¡®æ³¨å†Œ

### ä¸ºä»€ä¹ˆç»„ä»¶åç§°å¾ˆé‡è¦ï¼Ÿ

åœ¨ Vue Router ä¸­ï¼Œè·¯ç”±çš„ `name` ç”¨äºï¼š
- è·¯ç”±å¯¼èˆªï¼ˆ`router.push({ name: 'ComponentName' })`ï¼‰
- KeepAlive ç¼“å­˜ï¼ˆéœ€è¦åŒ¹é…ç»„ä»¶åç§°ï¼‰
- è·¯ç”±å®ˆå«ä¸­çš„è·¯ç”±è¯†åˆ«

å¦‚æœ `componentName` ä¸å‰ç«¯ç»„ä»¶çš„ `name` ä¸åŒ¹é…ï¼Œä¼šå¯¼è‡´ï¼š
- è·¯ç”±æ— æ³•æ­£ç¡®æ³¨å†Œ
- èœå•ç‚¹å‡»åæ— æ³•è·³è½¬
- KeepAlive ç¼“å­˜å¤±æ•ˆ

## âœ… éªŒè¯æ­¥éª¤

### 1. æ£€æŸ¥ç»„ä»¶åç§°

```bash
grep "defineOptions.*name" \
  original-yudao-ui/src/views/erp/finance/payment/index.vue \
  original-yudao-ui/src/views/erp/finance/receipt/index.vue \
  original-yudao-ui/src/views/erp/finance/account/index.vue
```

**é¢„æœŸè¾“å‡ºï¼š**
```
defineOptions({ name: 'ErpFinancePayment' })
defineOptions({ name: 'ErpFinanceReceipt' })
defineOptions({ name: 'ErpAccount' })
```

### 2. æ£€æŸ¥å‰ç«¯æ–‡ä»¶æ˜¯å¦æ›´æ–°

```bash
ssh -i tengxunyun.pem ubuntu@101.33.244.240 \
  "docker exec yudao-admin-prod stat -c '%y' /usr/share/nginx/html/index.html"
```

### 3. æµ‹è¯•èœå•åŠŸèƒ½

1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
2. é‡æ–°ç™»å½•ç³»ç»Ÿ
3. æ£€æŸ¥"è´¢åŠ¡ç®¡ç†"èœå•æ˜¯å¦æ˜¾ç¤º
4. ç‚¹å‡»"ä»˜æ¬¾å•"ã€"æ”¶æ¬¾å•"ã€"ç»“ç®—è´¦æˆ·"æµ‹è¯•è·³è½¬

## ğŸ¯ åç»­å»ºè®®

### 1. å»ºç«‹ç»„ä»¶åç§°è§„èŒƒ

å»ºè®®å»ºç«‹ç»„ä»¶å‘½åè§„èŒƒï¼Œç¡®ä¿ï¼š
- åç«¯èœå•çš„ `componentName` ä¸å‰ç«¯ç»„ä»¶çš„ `name` ä¿æŒä¸€è‡´
- ä½¿ç”¨ç»Ÿä¸€çš„å‘½åè§„åˆ™ï¼ˆå¦‚ï¼šæ¨¡å—å‰ç¼€ + åŠŸèƒ½åç§°ï¼‰

### 2. æ·»åŠ è‡ªåŠ¨åŒ–æ£€æŸ¥

å¯ä»¥åœ¨æ„å»ºæ—¶æ·»åŠ æ£€æŸ¥ï¼š
```bash
# æ£€æŸ¥ç»„ä»¶åç§°æ˜¯å¦åŒ¹é…
# ä»åç«¯APIè·å–èœå•æ•°æ®ï¼ŒéªŒè¯å‰ç«¯ç»„ä»¶åç§°
```

### 3. æ–‡æ¡£åŒ–ç»„ä»¶æ˜ å°„

å»ºè®®ç»´æŠ¤ä¸€ä¸ªæ–‡æ¡£ï¼Œè®°å½•ï¼š
- åç«¯èœå•é…ç½®
- å‰ç«¯ç»„ä»¶è·¯å¾„
- ç»„ä»¶åç§°æ˜ å°„å…³ç³»

## ğŸ“š ç›¸å…³æ–‡ä»¶

- è·¯ç”±ç”Ÿæˆé€»è¾‘: `original-yudao-ui/src/utils/routerHelper.ts`
- æƒé™ç®¡ç†: `original-yudao-ui/src/store/modules/permission.ts`
- ç”¨æˆ·ä¿¡æ¯: `original-yudao-ui/src/store/modules/user.ts`

---

**ä¿®å¤æ—¶é—´ï¼š** 2025-12-21  
**ä¿®å¤äººå‘˜ï¼š** AI Assistant  
**å½±å“èŒƒå›´ï¼š** è´¢åŠ¡ç®¡ç†æ¨¡å—ï¼ˆä»˜æ¬¾å•ã€æ”¶æ¬¾å•ï¼‰

