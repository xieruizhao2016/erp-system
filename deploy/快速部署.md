# å¿«é€Ÿéƒ¨ç½²æŒ‡å—

## ğŸ¯ éƒ¨ç½²æ–¹å¼é€‰æ‹©

### æ–¹å¼1ï¼šæœ¬åœ°æ„å»ºåä¸Šä¼ ï¼ˆæ¨èï¼Œé€‚åˆé¢‘ç¹æ›´æ–°ï¼‰

**ä¼˜åŠ¿ï¼š**
- âœ… åˆ©ç”¨æœ¬åœ°æ›´å¥½çš„ç¡¬ä»¶é…ç½®ï¼Œæ„å»ºé€Ÿåº¦æ›´å¿«
- âœ… å‡å°‘äº‘æœåŠ¡å™¨èµ„æºæ¶ˆè€—
- âœ… é¿å…äº‘æœåŠ¡å™¨ç½‘ç»œé—®é¢˜å¯¼è‡´çš„æ„å»ºå¤±è´¥
- âœ… å¯ä»¥æå‰éªŒè¯é•œåƒæ„å»ºæ˜¯å¦æˆåŠŸ

**å¿«é€Ÿå¼€å§‹ï¼š**
```bash
# 1. åœ¨æœ¬åœ°æ„å»ºé•œåƒ
cd /path/to/erp-system
./deploy/scripts/build-images-local.sh

# 2. å¯¼å‡ºé•œåƒ
./deploy/scripts/export-app-images.sh

# 3. ä¸Šä¼ å¹¶å¯¼å…¥åˆ°æœåŠ¡å™¨
./deploy/scripts/upload-app-images.sh

# 4. SSHåˆ°æœåŠ¡å™¨å¯åŠ¨æœåŠ¡
ssh -i ~/Documents/huoshan-ssh.pem root@115.190.240.137
cd /opt/erp-system/script/docker
docker-compose -f docker-compose.prod.yml --env-file .env up -d
```

ğŸ“– **è¯¦ç»†æ–‡æ¡£ï¼š** [æœ¬åœ°æ„å»ºéƒ¨ç½²æŒ‡å—](./docs/æœ¬åœ°æ„å»ºéƒ¨ç½²æŒ‡å—.md)

---

### æ–¹å¼2ï¼šåœ¨æœåŠ¡å™¨ä¸Šç›´æ¥æ„å»ºï¼ˆé€‚åˆé¦–æ¬¡éƒ¨ç½²ï¼‰

## ğŸš€ ä¸€é”®éƒ¨ç½²ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼‰

### åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# 1. ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨åï¼Œè¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/erp-system

# 2. è¿è¡Œå¿«é€Ÿç¯å¢ƒå‡†å¤‡è„šæœ¬ï¼ˆé¦–æ¬¡éƒ¨ç½²éœ€è¦ï¼‰
chmod +x deploy/scripts/quick-deploy.sh
./deploy/scripts/quick-deploy.sh

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp deploy/config/env.prod.example script/docker/.env
vi script/docker/.env  # ä¿®æ”¹å¯†ç ç­‰é…ç½®

# 4. è¿è¡Œéƒ¨ç½²è„šæœ¬
chmod +x deploy/scripts/deploy-volcano.sh
./deploy/scripts/deploy-volcano.sh
```

## ğŸ“ è¯¦ç»†æ­¥éª¤

### æ­¥éª¤1: å‡†å¤‡æœåŠ¡å™¨ç¯å¢ƒ

```bash
cd /opt/erp-system
./deploy/scripts/quick-deploy.sh
```

æ­¤è„šæœ¬ä¼šè‡ªåŠ¨å®‰è£…ï¼š
- Docker
- Docker Compose
- é…ç½®é˜²ç«å¢™è§„åˆ™

### æ­¥éª¤2: é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶é…ç½®ç¤ºä¾‹æ–‡ä»¶
cp deploy/config/env.prod.example script/docker/.env

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆå¿…é¡»ä¿®æ”¹å¯†ç ï¼‰
vi script/docker/.env
```

**å¿…é¡»ä¿®æ”¹çš„é…ç½®é¡¹ï¼š**
- `MYSQL_ROOT_PASSWORD`: æ•°æ®åº“rootå¯†ç 
- `MASTER_DATASOURCE_PASSWORD`: æ•°æ®åº“è¿æ¥å¯†ç 
- `SLAVE_DATASOURCE_PASSWORD`: ä»åº“è¿æ¥å¯†ç 
- `REDIS_PASSWORD`: Rediså¯†ç ï¼ˆå»ºè®®è®¾ç½®ï¼‰

### æ­¥éª¤3: æ„å»ºåç«¯ï¼ˆå¦‚éœ€è¦ï¼‰

å¦‚æœåç«¯JARæ–‡ä»¶ä¸å­˜åœ¨ï¼Œéƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨æ„å»ºã€‚ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ„å»ºï¼š

```bash
cd /opt/erp-system
mvn clean package -DskipTests
```

### æ­¥éª¤4: éƒ¨ç½²æœåŠ¡

```bash
cd /opt/erp-system
./deploy/scripts/deploy-volcano.sh
```

### æ­¥éª¤5: éªŒè¯éƒ¨ç½²

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
cd /opt/erp-system/script/docker
docker-compose -f docker-compose.prod.yml ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f

# è®¿é—®å‰ç«¯
# http://ä½ çš„æœåŠ¡å™¨IP

# è®¿é—®åç«¯API
# http://ä½ çš„æœåŠ¡å™¨IP:48080
```

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
cd /opt/erp-system/script/docker
docker-compose -f docker-compose.prod.yml ps
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.prod.yml logs -f

# ç‰¹å®šæœåŠ¡
docker-compose -f docker-compose.prod.yml logs -f server
docker-compose -f docker-compose.prod.yml logs -f admin
```

### é‡å¯æœåŠ¡
```bash
docker-compose -f docker-compose.prod.yml restart
```

### åœæ­¢æœåŠ¡
```bash
docker-compose -f docker-compose.prod.yml down
```

### æ›´æ–°æœåŠ¡

**æ–¹å¼1ï¼šåœ¨æœåŠ¡å™¨ä¸Šé‡æ–°æ„å»ºï¼ˆè¾ƒæ…¢ï¼‰**
```bash
# æ‹‰å–æœ€æ–°ä»£ç å
docker-compose -f docker-compose.prod.yml up -d --build
```

**æ–¹å¼2ï¼šæœ¬åœ°æ„å»ºåä¸Šä¼ ï¼ˆæ¨èï¼Œæ›´å¿«ï¼‰**
```bash
# åœ¨æœ¬åœ°æ‰§è¡Œ
./deploy/scripts/build-images-local.sh
./deploy/scripts/export-app-images.sh
./deploy/scripts/upload-app-images.sh

# åœ¨æœåŠ¡å™¨ä¸Šé‡å¯æœåŠ¡
cd /opt/erp-system/script/docker
docker-compose -f docker-compose.prod.yml --env-file .env up -d --force-recreate
```

## âš ï¸ é‡è¦æç¤º

1. **é¦–æ¬¡éƒ¨ç½²å¿…é¡»ä¿®æ”¹å¯†ç **
   - ç¼–è¾‘ `script/docker/.env` æ–‡ä»¶
   - ä¿®æ”¹æ‰€æœ‰åŒ…å«"è¯·ä¿®æ”¹ä¸ºå¼ºå¯†ç "çš„é…ç½®é¡¹

2. **é»˜è®¤ç™»å½•è´¦å·**
   - ç”¨æˆ·åï¼šadmin
   - å¯†ç ï¼šadmin123
   - âš ï¸ é¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹å¯†ç ï¼

3. **ç«¯å£è¦æ±‚**
   - ç¡®ä¿é˜²ç«å¢™å¼€æ”¾ 80 å’Œ 48080 ç«¯å£

4. **æœåŠ¡å™¨è¦æ±‚**
   - æœ€ä½é…ç½®ï¼š2æ ¸4G
   - æ¨èé…ç½®ï¼š4æ ¸8G

## ğŸ“š æ›´å¤šæ–‡æ¡£

- **æœ¬åœ°æ„å»ºéƒ¨ç½²æŒ‡å—**: [docs/æœ¬åœ°æ„å»ºéƒ¨ç½²æŒ‡å—.md](./docs/æœ¬åœ°æ„å»ºéƒ¨ç½²æŒ‡å—.md) â­ æ¨è
- **å®Œæ•´éƒ¨ç½²æŒ‡å—**: [docs/ç«å±±å¼•æ“éƒ¨ç½²æŒ‡å—.md](./docs/ç«å±±å¼•æ“éƒ¨ç½²æŒ‡å—.md)
- **å¿«é€Ÿå¼€å§‹**: [docs/ç«å±±å¼•æ“å¿«é€Ÿå¼€å§‹.md](./docs/ç«å±±å¼•æ“å¿«é€Ÿå¼€å§‹.md)
- **æ£€æŸ¥æ¸…å•**: [docs/éƒ¨ç½²æ£€æŸ¥æ¸…å•.md](./docs/éƒ¨ç½²æ£€æŸ¥æ¸…å•.md)

## ğŸ†˜ é‡åˆ°é—®é¢˜ï¼Ÿ

1. æŸ¥çœ‹å®Œæ•´éƒ¨ç½²æŒ‡å—ä¸­çš„"å¸¸è§é—®é¢˜"éƒ¨åˆ†
2. æŸ¥çœ‹éƒ¨ç½²æ£€æŸ¥æ¸…å•
3. æ£€æŸ¥æœåŠ¡æ—¥å¿—ï¼š`docker-compose logs`
4. æäº¤Issueè·å–å¸®åŠ©

---

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼** ğŸ‰

